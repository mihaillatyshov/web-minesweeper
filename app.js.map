{"version":3,"file":"app.js","mappings":"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","sources":["webpack:///./src/styles.css","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack:///./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack:///./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack:///./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack:///./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/nonce","webpack:///./src/GameWidnow.ts","webpack:///./src/Game/Constants.ts","webpack:///./src/FieldSerializer.ts","webpack:///./src/WebGpu/WebGpuInstance.ts","webpack:///./src/Game/IField.ts","webpack:///./src/WebGpu/WebGpuBuffer.ts","webpack:///./src/WebGpu/Matrices.ts","webpack:///./src/WebGpu/WebGpuTexture.ts","webpack:///./src/Theme.ts","webpack:///./src/Game/IUi.ts","webpack:///./src/WebGpu/WebGpuUi.ts","webpack:///./src/HtmlCanvas/HtmlCanvasInstance.ts","webpack:///./src/HtmlCanvas/HtmlCanvasTexture.ts","webpack:///./src/styles.css?44b2","webpack:///./src/index.ts","webpack:///./src/HtmlCanvas/HtmlCanvasField.ts","webpack:///./src/HtmlCanvas/HtmlCanvasUi.ts","webpack:///./src/WebGpu/WebGpuField.ts","webpack:///./src/Game/GameLogic.ts","webpack:///./src/Game/Utils.ts"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"* {\\r\\n    padding: 0;\\r\\n    margin: 0;\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\n:root {\\r\\n    --font-color: #333;\\r\\n    --bg-color: #f8f9fa;\\r\\n}\\r\\n\\r\\n[data-theme=\\\"dark\\\"] {\\r\\n    --font-color: #fff;\\r\\n    --bg-color: #343a40;\\r\\n}\\r\\n\\r\\nbody {\\r\\n    padding: 16px;\\r\\n    height: 100vh;\\r\\n    height: 100dvh;\\r\\n    text-align: center;\\r\\n    color: var(--font-color);\\r\\n    background-color: var(--bg-color);\\r\\n}\\r\\n\\r\\n#theme-switch {\\r\\n    position: absolute;\\r\\n    top: 16px;\\r\\n    right: 16px;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n#checkbox-theme {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n#nav {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    margin-bottom: 16px;\\r\\n    gap: 12px;\\r\\n}\\r\\n\\r\\n#app {\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.form-field {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\n.nav-inputs {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 16px;\\r\\n    align-items: end;\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.renderer-text-block {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\ninput {\\r\\n    padding: 8px;\\r\\n    border: 1px solid #ccc;\\r\\n    border-radius: 4px;\\r\\n}\\r\\n\\r\\ninput[type=\\\"submit\\\"] {\\r\\n    background-color: #007bff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"submit\\\"]:hover {\\r\\n    background-color: #0056b3;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"] {\\r\\n    background-color: #007bff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"]:hover {\\r\\n    background-color: #0056b3;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"]:disabled {\\r\\n    background-color: #9cccff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.text-danger {\\r\\n    color: red;\\r\\n}\\r\\n\\r\\n#error-message {\\r\\n    font-size: 24px;\\r\\n}\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/styles.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,UAAU;IACV,SAAS;IACT,sBAAsB;AAC1B;;AAEA;IACI,kBAAkB;IAClB,mBAAmB;AACvB;;AAEA;IACI,kBAAkB;IAClB,mBAAmB;AACvB;;AAEA;IACI,aAAa;IACb,aAAa;IACb,cAAc;IACd,kBAAkB;IAClB,wBAAwB;IACxB,iCAAiC;AACrC;;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,WAAW;IACX,eAAe;AACnB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,aAAa;IACb,sBAAsB;AAC1B;;AAEA;IACI,aAAa;IACb,eAAe;IACf,SAAS;IACT,gBAAgB;IAChB,cAAc;AAClB;;AAEA;IACI,aAAa;IACb,sBAAsB;AAC1B;;AAEA;IACI,YAAY;IACZ,sBAAsB;IACtB,kBAAkB;AACtB;;AAEA;IACI,yBAAyB;IACzB,YAAY;IACZ,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,yBAAyB;IACzB,YAAY;IACZ,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,yBAAyB;IACzB,YAAY;IACZ,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,yBAAyB;IACzB,YAAY;IACZ,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,yBAAyB;IACzB,YAAY;IACZ,YAAY;IACZ,eAAe;AACnB;;AAEA;IACI,UAAU;AACd;;AAEA;IACI,eAAe;AACnB\",\"sourcesContent\":[\"* {\\r\\n    padding: 0;\\r\\n    margin: 0;\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\n:root {\\r\\n    --font-color: #333;\\r\\n    --bg-color: #f8f9fa;\\r\\n}\\r\\n\\r\\n[data-theme=\\\"dark\\\"] {\\r\\n    --font-color: #fff;\\r\\n    --bg-color: #343a40;\\r\\n}\\r\\n\\r\\nbody {\\r\\n    padding: 16px;\\r\\n    height: 100vh;\\r\\n    height: 100dvh;\\r\\n    text-align: center;\\r\\n    color: var(--font-color);\\r\\n    background-color: var(--bg-color);\\r\\n}\\r\\n\\r\\n#theme-switch {\\r\\n    position: absolute;\\r\\n    top: 16px;\\r\\n    right: 16px;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n#checkbox-theme {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n#nav {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    margin-bottom: 16px;\\r\\n    gap: 12px;\\r\\n}\\r\\n\\r\\n#app {\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.form-field {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\n.nav-inputs {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 16px;\\r\\n    align-items: end;\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.renderer-text-block {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\ninput {\\r\\n    padding: 8px;\\r\\n    border: 1px solid #ccc;\\r\\n    border-radius: 4px;\\r\\n}\\r\\n\\r\\ninput[type=\\\"submit\\\"] {\\r\\n    background-color: #007bff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"submit\\\"]:hover {\\r\\n    background-color: #0056b3;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"] {\\r\\n    background-color: #007bff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"]:hover {\\r\\n    background-color: #0056b3;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\ninput[type=\\\"button\\\"]:disabled {\\r\\n    background-color: #9cccff;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.text-danger {\\r\\n    color: red;\\r\\n}\\r\\n\\r\\n#error-message {\\r\\n    font-size: 24px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.nc = undefined;","type TMouseButtonEventFunc = (button: number) => void;\r\ntype TWheelEventFunc = (x: number, y: number) => void;\r\n\r\nexport class GameWindow {\r\n    private canvas: HTMLCanvasElement;\r\n    private mouseButtonsPressed: Set<number> = new Set();\r\n    private mousePosition: [number, number] = [0, 0];\r\n    private onMouseButtonDown: TMouseButtonEventFunc | undefined;\r\n    private onMouseButtonUp: TMouseButtonEventFunc | undefined;\r\n    private onWheel: TWheelEventFunc | undefined;\r\n\r\n    constructor(\r\n        canvas: HTMLCanvasElement,\r\n        onMouseButtonDown?: TMouseButtonEventFunc,\r\n        onMouseButtonUp?: TMouseButtonEventFunc,\r\n        onWheel?: TWheelEventFunc\r\n    ) {\r\n        this.canvas = canvas;\r\n\r\n        this.onMouseButtonDown = onMouseButtonDown;\r\n        this.onMouseButtonUp = onMouseButtonUp;\r\n        this.onWheel = onWheel;\r\n\r\n        window.addEventListener(\"mousedown\", (e) => {\r\n            this.mouseButtonsPressed.add(e.button);\r\n            this.onMouseButtonDown && this.onMouseButtonDown(e.button);\r\n        });\r\n\r\n        window.addEventListener(\"mouseup\", (e) => {\r\n            this.mouseButtonsPressed.delete(e.button);\r\n            this.onMouseButtonUp && this.onMouseButtonUp(e.button);\r\n        });\r\n\r\n        window.addEventListener(\"mousemove\", (e) => {\r\n            this.mousePosition = [e.clientX, e.clientY];\r\n        });\r\n\r\n        window.addEventListener(\"contextmenu\", (e) => {\r\n            e.preventDefault();\r\n        });\r\n        canvas.addEventListener(\"wheel\", (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            const x = e.shiftKey ? -e.deltaY : -e.deltaX;\r\n            const y = e.shiftKey ? e.deltaX : e.deltaY;\r\n            this.onWheel && this.onWheel(x, y);\r\n        });\r\n    }\r\n\r\n    setOnMouseButtonDown(func: TMouseButtonEventFunc) {\r\n        this.onMouseButtonDown = func;\r\n    }\r\n\r\n    setOnMouseButtonUp(func: TMouseButtonEventFunc) {\r\n        this.onMouseButtonUp = func;\r\n    }\r\n\r\n    setOnWheel(func: TWheelEventFunc) {\r\n        this.onWheel = func;\r\n    }\r\n\r\n    isMouseButtonPressed(button: number): boolean {\r\n        return this.mouseButtonsPressed.has(button);\r\n    }\r\n\r\n    getMousePosition() {\r\n        return {\r\n            x: this.mousePosition[0] - this.canvas.getBoundingClientRect().left,\r\n            y: this.canvas.getBoundingClientRect().bottom - this.mousePosition[1],\r\n        };\r\n    }\r\n\r\n    isMouseInside() {\r\n        const mousePos = this.getMousePosition();\r\n        return mousePos.x >= 0 && mousePos.y >= 0 && mousePos.x < this.canvas.width && mousePos.y < this.canvas.height;\r\n    }\r\n}\r\n","import { Vec2 } from \"Types\";\r\n\r\nexport const FIELD_CELL_SIZE = 32;\r\n\r\nexport const TEXT_SIZE: Vec2 = [42, 80];\r\n\r\nexport const BORDER_X = 24;\r\nexport const BORDER_Y = 22;\r\nexport const INFO_Y = 64;\r\nexport const TEXT_X = 82;\r\nexport const TEXT_Y = 50;\r\nexport const FACE_SIZE = 52;\r\n\r\nexport const TEXT_SYM_X = 22;\r\nexport const TEXT_SYM_Y = 42;\r\nexport const TEXT_SYM_SIZE: Vec2 = [TEXT_SYM_X, TEXT_SYM_Y];\r\nexport const TEXT_SYM_OFF_X = (TEXT_X - TEXT_SYM_X * 3) / 4;\r\nexport const TEXT_SYM_OFF_Y = (TEXT_Y - TEXT_SYM_Y) / 2;\r\n\r\nexport const TEXT_PAD = (INFO_Y - TEXT_Y) / 2;\r\n\r\nexport const SCROLL_POINT_X = 12;\r\nexport const SCROLL_POINT_Y = 32;\r\n\r\nexport const CAMERA_OFFSET_X = BORDER_X;\r\nexport const CAMERA_OFFSET_Y = BORDER_Y;\r\n\r\nexport const TEXTURE_SIZE = 512;\r\n","import { GameLogic } from \"Game/GameLogic\";\r\n\r\ntype TRendererType = \"canvas\" | \"webgpu\";\r\n\r\nexport const getRendererType = () => {\r\n    const rendererType = localStorage.getItem(\"rendererType\") as TRendererType | null;\r\n    return rendererType || \"canvas\";\r\n};\r\n\r\nexport const switchRendererType = () => {\r\n    const rendererType = getRendererType();\r\n    const newRendererType = rendererType === \"canvas\" ? \"webgpu\" : \"canvas\";\r\n    localStorage.setItem(\"rendererType\", newRendererType);\r\n    window.location.reload();\r\n};\r\n\r\nexport const getStartupInputs = () => {\r\n    const params = new URLSearchParams(window.location.search);\r\n\r\n    const cols = parseInt(params.get(\"cols\") || \"9\");\r\n    const rows = parseInt(params.get(\"rows\") || \"9\");\r\n    const mines = parseInt(params.get(\"mines\") || \"10\");\r\n    const load = params.get(\"load\");\r\n\r\n    return { cols, rows, mines, load };\r\n};\r\n\r\nexport const startNewGame = (cols: number | string, rows: number | string, mines: number | string) => {\r\n    window.location.href = `?cols=${cols}&rows=${rows}&mines=${mines}`;\r\n};\r\n\r\nexport class GameDataBase {\r\n    private db: IDBDatabase | null = null;\r\n\r\n    constructor(onDBReady: () => void, onDBError: () => void) {\r\n        const openRequest = window.indexedDB.open(\"minesweeper\", 1);\r\n\r\n        openRequest.onsuccess = () => {\r\n            this.db = openRequest.result;\r\n            onDBReady();\r\n        };\r\n\r\n        openRequest.onerror = () => {\r\n            onDBError();\r\n        };\r\n\r\n        openRequest.onupgradeneeded = () => {\r\n            this.db = openRequest.result;\r\n            this.db.createObjectStore(\"games\", { keyPath: \"id\" });\r\n        };\r\n    }\r\n\r\n    saveGame(gameLogic: GameLogic) {\r\n        const data = gameLogic.save();\r\n        const tx = this.db?.transaction(\"games\", \"readwrite\");\r\n        const store = tx?.objectStore(\"games\");\r\n        store?.put({ id: 1, data });\r\n    }\r\n\r\n    loadGame(gameLogic: GameLogic, onLoadSuccess: () => void, onLoadError: () => void) {\r\n        const tx = this.db?.transaction(\"games\", \"readonly\");\r\n        const store = tx?.objectStore(\"games\");\r\n        const request = store?.get(1);\r\n        if (!request) {\r\n            console.error(\"Error loading game\");\r\n            return undefined;\r\n        }\r\n        request.onsuccess = () => {\r\n            console.log(request);\r\n            if (!request.result) {\r\n                onLoadError();\r\n                return;\r\n            }\r\n            gameLogic.load(request.result.data);\r\n            onLoadSuccess();\r\n        };\r\n        request.onerror = () => {\r\n            // TODO: handle error\r\n        };\r\n    }\r\n}\r\n","import { IRendererInstance } from \"Game/IRendererInstance\";\r\n\r\nexport class WebGpuInstance implements IRendererInstance {\r\n    private adapter: GPUAdapter | null = null;\r\n    private device: GPUDevice | null = null;\r\n\r\n    private canvas: HTMLCanvasElement | null = null;\r\n    private context: GPUCanvasContext | null = null;\r\n\r\n    private currentFrameCommandEncoder: GPUCommandEncoder | null = null;\r\n    private currentFramePassEncoder: GPURenderPassEncoder | null = null;\r\n\r\n    constructor() {}\r\n\r\n    async init(canvas: HTMLCanvasElement) {\r\n        this.canvas = canvas;\r\n\r\n        console.log(\"WebGPU init\");\r\n\r\n        try {\r\n            const instance = navigator.gpu;\r\n            if (!instance) {\r\n                throw new Error(\"WebGPU is not supported\");\r\n            }\r\n\r\n            this.adapter = await instance.requestAdapter();\r\n            if (!this.adapter) {\r\n                throw new Error(\"WebGPU no adapter found\");\r\n            }\r\n\r\n            this.device = await this.adapter.requestDevice();\r\n            if (!this.device) {\r\n                throw new Error(\"WebGPU no device found\");\r\n            }\r\n\r\n            const presentationFormat = navigator.gpu.getPreferredCanvasFormat();\r\n\r\n            this.context = this.canvas.getContext(\"webgpu\") as GPUCanvasContext;\r\n            const canvasConfig: GPUCanvasConfiguration = {\r\n                device: this.device,\r\n                format: presentationFormat,\r\n                alphaMode: \"premultiplied\",\r\n                usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\r\n            };\r\n            this.context.configure(canvasConfig);\r\n\r\n            gWebGpuInstance = this;\r\n        } catch (e) {\r\n            console.error(e);\r\n            throw e;\r\n        }\r\n    }\r\n\r\n    private getColorTextureView(): GPUTextureView {\r\n        if (!this.context) {\r\n            throw new Error(\"WebGPU context not initialized\");\r\n        }\r\n        return this.context.getCurrentTexture().createView();\r\n    }\r\n\r\n    getDevice(): GPUDevice {\r\n        if (!this.device) {\r\n            throw new Error(\"WebGPU device not initialized\");\r\n        }\r\n        return this.device;\r\n    }\r\n\r\n    beginFrame() {\r\n        if (!this.device) {\r\n            throw new Error(\"WebGPU device not initialized\");\r\n        }\r\n\r\n        let colorAttachment: GPURenderPassColorAttachment = {\r\n            view: this.getColorTextureView(),\r\n            clearValue: { r: 0, g: 0, b: 0, a: 1 },\r\n            loadOp: \"clear\",\r\n            storeOp: \"store\",\r\n        };\r\n\r\n        const renderPassDesc: GPURenderPassDescriptor = {\r\n            colorAttachments: [colorAttachment],\r\n        };\r\n\r\n        this.currentFrameCommandEncoder = this.device.createCommandEncoder();\r\n\r\n        this.currentFramePassEncoder = this.currentFrameCommandEncoder.beginRenderPass(renderPassDesc);\r\n    }\r\n\r\n    endFrame() {\r\n        if (!this.device) {\r\n            throw new Error(\"WebGPU device not initialized\");\r\n        }\r\n        if (!this.currentFramePassEncoder || !this.currentFrameCommandEncoder) {\r\n            throw new Error(\"WebGPU beginFrame() was not called\");\r\n        }\r\n\r\n        this.currentFramePassEncoder.end();\r\n\r\n        this.device.queue.submit([this.currentFrameCommandEncoder.finish()]);\r\n    }\r\n\r\n    getPassEncoder(): GPURenderPassEncoder {\r\n        if (!this.currentFramePassEncoder) {\r\n            throw new Error(\"WebGPU beginFrame() was not called\");\r\n        }\r\n        return this.currentFramePassEncoder;\r\n    }\r\n}\r\n\r\nexport let gWebGpuInstance: WebGpuInstance | null = null;\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport { BORDER_X, BORDER_Y, CAMERA_OFFSET_X, CAMERA_OFFSET_Y, FIELD_CELL_SIZE, INFO_Y } from \"Game/Constants\";\r\n\r\nconst DRAW_NOT_ALLIGNED_BIAS = 3;\r\n\r\nconst TEXTURE_FIELD_OPENED_ZERO = 0;\r\nconst TEXTURE_FIELD_CLOSED = 17;\r\nconst TEXTURE_FIELD_PRESSED = 18;\r\nconst TEXTURE_FIELD_MINE_MARKED = 19;\r\nconst TEXTURE_FIELD_MINE_MARKED_WRONG = 20;\r\nconst TEXTURE_FIELD_MINE = 21;\r\nconst TEXTURE_FIELD_MINE_WRONG = 22;\r\nconst TEXTURE_FIELD_EMPTY = 23;\r\n\r\nexport interface TFieldCameraState {\r\n    isOnRight: boolean;\r\n    isOnBottom: boolean;\r\n    isOnLeft: boolean;\r\n    isOnTop: boolean;\r\n}\r\n\r\nexport class GameField {\r\n    protected windowWidth: number = 0;\r\n    protected windowHeight: number = 0;\r\n\r\n    protected cameraPosition = { x: 0, y: 0 };\r\n\r\n    baseInit(width: number, height: number) {\r\n        this.windowWidth = width;\r\n        this.windowHeight = height;\r\n    }\r\n\r\n    private isScrollAllowed() {\r\n        return true;\r\n    }\r\n\r\n    calcCameraMaxLimits(gameLogic: GameLogic) {\r\n        return {\r\n            x: -(gameLogic.getFieldColSize() * FIELD_CELL_SIZE - (this.windowWidth - BORDER_X * 2)),\r\n            y: -(gameLogic.getFieldRowSize() * FIELD_CELL_SIZE - (this.windowHeight - BORDER_Y * 3 - INFO_Y)),\r\n        };\r\n    }\r\n\r\n    moveCamera(gameLogic: GameLogic, x: number, y: number) {\r\n        if (this.isScrollAllowed()) {\r\n            this.cameraPosition.x += x;\r\n            this.cameraPosition.y += y;\r\n        }\r\n\r\n        const { x: maxX, y: maxY } = this.calcCameraMaxLimits(gameLogic);\r\n\r\n        this.cameraPosition.x = Math.min(0, Math.max(maxX, this.cameraPosition.x));\r\n        this.cameraPosition.y = Math.min(0, Math.max(maxY, this.cameraPosition.y));\r\n    }\r\n\r\n    getHoveredCell(gameWindow: GameWindow) {\r\n        return {\r\n            col: Math.floor(\r\n                (gameWindow.getMousePosition().x - this.cameraPosition.x - CAMERA_OFFSET_X) / FIELD_CELL_SIZE\r\n            ),\r\n            row: Math.floor(\r\n                (gameWindow.getMousePosition().y - this.cameraPosition.y - CAMERA_OFFSET_Y) / FIELD_CELL_SIZE\r\n            ),\r\n        };\r\n    }\r\n\r\n    isMouseInside(gameWindow: GameWindow) {\r\n        const { x, y } = gameWindow.getMousePosition();\r\n        return (\r\n            gameWindow.isMouseInside() &&\r\n            x > BORDER_X &&\r\n            y > BORDER_Y &&\r\n            x < this.windowWidth - BORDER_X &&\r\n            y < this.windowHeight - BORDER_Y * 2 - INFO_Y\r\n        );\r\n    }\r\n\r\n    getFieldCameraState(gameLogic: GameLogic): TFieldCameraState {\r\n        const epsilon = 0.01;\r\n        const { x: maxX, y: maxY } = this.calcCameraMaxLimits(gameLogic);\r\n        return {\r\n            isOnBottom: Math.abs(this.cameraPosition.y) < epsilon,\r\n            isOnTop: Math.abs(this.cameraPosition.y - maxY) < epsilon,\r\n            isOnLeft: Math.abs(this.cameraPosition.x) < epsilon,\r\n            isOnRight: Math.abs(this.cameraPosition.x - maxX) < epsilon,\r\n        };\r\n    }\r\n\r\n    getMaxFieldRowAndColCount(width: number, height: number) {\r\n        return {\r\n            maxDrawColCount: Math.floor(width / FIELD_CELL_SIZE) + DRAW_NOT_ALLIGNED_BIAS,\r\n            maxDrawRowCount: Math.floor(height / FIELD_CELL_SIZE) + DRAW_NOT_ALLIGNED_BIAS,\r\n        };\r\n    }\r\n\r\n    getFieldTextureId = (gameLogic: GameLogic, col: number, row: number, isPressed: boolean): number => {\r\n        if (!gameLogic.isCellExists(col, row)) {\r\n            return TEXTURE_FIELD_EMPTY;\r\n        }\r\n\r\n        if (gameLogic.isGameOver()) {\r\n            if (gameLogic.isCellMarked(col, row) && !gameLogic.isCellHasMine(col, row)) {\r\n                return TEXTURE_FIELD_MINE_MARKED_WRONG;\r\n            }\r\n            if (gameLogic.isCellHasMine(col, row) && gameLogic.isCellOpened(col, row)) {\r\n                return TEXTURE_FIELD_MINE_WRONG;\r\n            }\r\n            if (gameLogic.isCellMarked(col, row)) {\r\n                return TEXTURE_FIELD_MINE_MARKED;\r\n            }\r\n            if (gameLogic.isCellHasMine(col, row)) {\r\n                return TEXTURE_FIELD_MINE;\r\n            }\r\n        } else if (gameLogic.isGameWin()) {\r\n            if (gameLogic.isCellHasMine(col, row)) {\r\n                return TEXTURE_FIELD_MINE_MARKED;\r\n            }\r\n        }\r\n\r\n        if (gameLogic.isCellMarked(col, row)) {\r\n            return TEXTURE_FIELD_MINE_MARKED;\r\n        }\r\n\r\n        if (isPressed && gameLogic.isCellClosed(col, row)) {\r\n            return TEXTURE_FIELD_PRESSED;\r\n        }\r\n\r\n        if (gameLogic.isCellOpened(col, row)) {\r\n            return TEXTURE_FIELD_OPENED_ZERO + gameLogic.getCellMinesCount(col, row);\r\n        }\r\n\r\n        return TEXTURE_FIELD_CLOSED;\r\n    };\r\n}\r\n\r\nexport interface IField extends GameField {\r\n    init(width: number, height: number): Promise<void>;\r\n    update(gameLogic: GameLogic, gameWindow: GameWindow): void;\r\n    draw(): void;\r\n}\r\n\r\nexport interface IFieldConstructor {\r\n    new (): IField;\r\n}\r\n","export const createWebGpuBufferWithData = <TData extends Float32ArrayConstructor | Uint32ArrayConstructor>(\r\n    device: GPUDevice,\r\n    inData: number[][] | number[],\r\n    dataType: TData,\r\n    usage: GPUBufferUsageFlags\r\n): GPUBuffer => {\r\n    const data = new dataType(inData.flat());\r\n    const bufferDescriptor: GPUBufferDescriptor = {\r\n        size: data.byteLength,\r\n        usage,\r\n        mappedAtCreation: true,\r\n    };\r\n    const buffer = device.createBuffer(bufferDescriptor);\r\n    new dataType(buffer.getMappedRange()).set(data);\r\n    buffer.unmap();\r\n    return buffer;\r\n};\r\n\r\nexport const createWebGpuBufferDynamic = <TData extends Float32ArrayConstructor | Uint32ArrayConstructor>(\r\n    device: GPUDevice,\r\n    size: number,\r\n    dataType: TData,\r\n    usage: GPUBufferUsageFlags\r\n): GPUBuffer => {\r\n    const bufferDescriptor: GPUBufferDescriptor = {\r\n        size: size * dataType.BYTES_PER_ELEMENT,\r\n        usage: usage | GPUBufferUsage.COPY_DST,\r\n    };\r\n    const buffer = device.createBuffer(bufferDescriptor);\r\n    return buffer;\r\n};\r\n","export const Float32ArrayConcat = (a: Float32Array, b: Float32Array): Float32Array => {\r\n    const result = new Float32Array(a.length + b.length);\r\n    result.set(a);\r\n    result.set(b, a.length);\r\n    return result;\r\n};\r\n\r\nexport const createOrthographicMatrix = (\r\n    left: number,\r\n    right: number,\r\n    bottom: number,\r\n    top: number,\r\n    near: number,\r\n    far: number\r\n): Float32Array => {\r\n    // prettier-ignore\r\n    return new Float32Array([\r\n        2 / (right - left)             , 0                              , 0                  , 0,\r\n        0                              , 2 / (top - bottom)             , 0                  , 0,\r\n        0                              , 0                              , 1 / (far - near)   , 0,\r\n        (left + right) / (left - right), (top + bottom) / (bottom - top), near / (near - far), 1,\r\n    ]);\r\n};\r\n\r\nexport const createTranslationMatrix = (x: number, y: number, z: number): Float32Array => {\r\n    // prettier-ignore\r\n    return new Float32Array([\r\n        1, 0, 0, 0,\r\n        0, 1, 0, 0,\r\n        0, 0, 1, 0,\r\n        x, y, z, 1,\r\n    ]);\r\n};\r\n","export const createWebGpuTexture = async (device: GPUDevice, filename: string): Promise<GPUTexture> => {\r\n    const response = await fetch(filename);\r\n    const imageBitmap = await createImageBitmap(await response.blob());\r\n\r\n    const texture = device.createTexture({\r\n        size: [imageBitmap.width, imageBitmap.height, 1],\r\n        format: \"rgba8unorm\",\r\n        usage: GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.RENDER_ATTACHMENT,\r\n    });\r\n    device.queue.copyExternalImageToTexture({ source: imageBitmap }, { texture }, [\r\n        imageBitmap.width,\r\n        imageBitmap.height,\r\n    ]);\r\n\r\n    return texture;\r\n};\r\n","//determines if the user has a set theme\r\nexport const detectColorScheme = () => {\r\n    let theme = \"light\"; //default to light\r\n\r\n    //local storage is used to override OS theme settings\r\n    if (localStorage.getItem(\"theme\")) {\r\n        if (localStorage.getItem(\"theme\") == \"dark\") {\r\n            theme = \"dark\";\r\n        }\r\n    } else if (!window.matchMedia) {\r\n        //matchMedia method not supported\r\n        return false;\r\n    } else if (window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\r\n        //OS theme setting detected as dark\r\n        theme = \"dark\";\r\n    }\r\n\r\n    //dark theme preferred, set document with a `data-theme` attribute\r\n    if (theme == \"dark\") {\r\n        document.documentElement.setAttribute(\"data-theme\", \"dark\");\r\n    }\r\n};\r\n\r\nexport const getTheme = () => {\r\n    return document.documentElement.getAttribute(\"data-theme\") || \"light\";\r\n};\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport {\r\n    BORDER_X,\r\n    BORDER_Y,\r\n    FACE_SIZE,\r\n    INFO_Y,\r\n    SCROLL_POINT_X,\r\n    SCROLL_POINT_Y,\r\n    TEXT_PAD,\r\n    TEXT_SYM_OFF_X,\r\n    TEXT_SYM_OFF_Y,\r\n    TEXT_SYM_X,\r\n    TEXT_X,\r\n    TEXT_Y,\r\n} from \"Game/Constants\";\r\nimport { TFieldCameraState } from \"Game/IField\";\r\n\r\nimport { Vec2 } from \"Types\";\r\n\r\nconst TEXT_0: Vec2 = [128, 192] as const;\r\nconst TEXT_1: Vec2 = [170, 192] as const;\r\nconst TEXT_2: Vec2 = [212, 192] as const;\r\nconst TEXT_3: Vec2 = [254, 192] as const;\r\nconst TEXT_4: Vec2 = [296, 192] as const;\r\nconst TEXT_5: Vec2 = [338, 192] as const;\r\nconst TEXT_6: Vec2 = [380, 192] as const;\r\nconst TEXT_7: Vec2 = [422, 192] as const;\r\nconst TEXT_8: Vec2 = [464, 192] as const;\r\nconst TEXT_9: Vec2 = [0, 272] as const;\r\n\r\nexport const TEXT_ARRAY: Vec2[] = [\r\n    TEXT_0,\r\n    TEXT_1,\r\n    TEXT_2,\r\n    TEXT_3,\r\n    TEXT_4,\r\n    TEXT_5,\r\n    TEXT_6,\r\n    TEXT_7,\r\n    TEXT_8,\r\n    TEXT_9,\r\n] as const;\r\n\r\nexport class GameUi {\r\n    protected windowWidth: number = 0;\r\n    protected windowHeight: number = 0;\r\n\r\n    protected mouseOnFaceDown = false;\r\n\r\n    baseInit(width: number, height: number) {\r\n        this.windowWidth = width;\r\n        this.windowHeight = height;\r\n    }\r\n\r\n    isMouseInsideFace(gameWindow: GameWindow) {\r\n        const mousePos = gameWindow.getMousePosition();\r\n        const faceOffsetX = this.windowWidth / 2 - FACE_SIZE / 2;\r\n        const faceOffsetY = this.windowHeight - BORDER_Y - INFO_Y / 2 - FACE_SIZE / 2;\r\n\r\n        return (\r\n            mousePos.x >= faceOffsetX &&\r\n            mousePos.x <= faceOffsetX + FACE_SIZE &&\r\n            mousePos.y >= faceOffsetY &&\r\n            mousePos.y <= faceOffsetY + FACE_SIZE\r\n        );\r\n    }\r\n\r\n    checkFaceClickDown(gameWindow: GameWindow) {\r\n        this.mouseOnFaceDown = this.isMouseInsideFace(gameWindow);\r\n    }\r\n\r\n    checkFaceClickUp(gameLogic: GameLogic, gameWindow: GameWindow) {\r\n        if (this.mouseOnFaceDown && this.isMouseInsideFace(gameWindow)) {\r\n            gameLogic.generateField();\r\n        }\r\n        this.mouseOnFaceDown = false;\r\n    }\r\n}\r\n\r\nexport interface IUi extends GameUi {\r\n    init(width: number, height: number): Promise<void>;\r\n    update(gameLogic: GameLogic, fieldCameraState: TFieldCameraState, gameWindow: GameWindow): void;\r\n    draw(): void;\r\n}\r\n\r\nexport interface IUiConstructor {\r\n    new (): IUi;\r\n}\r\n\r\nexport interface TUiSpriteData {\r\n    spritePos: Vec2;\r\n    spriteSize: Vec2;\r\n    atlasPos: Vec2;\r\n    atlasSize: Vec2;\r\n}\r\n\r\nexport const createUiSpriteData = (\r\n    spritePos: Vec2,\r\n    spriteSize: Vec2,\r\n    atlasPos: Vec2,\r\n    atlasSize: Vec2\r\n): TUiSpriteData => ({\r\n    spritePos,\r\n    spriteSize,\r\n    atlasPos,\r\n    atlasSize,\r\n});\r\n\r\nconst textBlockOffsetY = (height: number) => height - BORDER_Y - INFO_Y / 2 - TEXT_Y / 2;\r\n\r\n/* prettier-ignore */ export const uiFrameBorderBotLeft     = (width: number, height: number) => createUiSpriteData([0                                   , 0                             ], [BORDER_X                , BORDER_Y             ], [162, 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderBotRight    = (width: number, height: number) => createUiSpriteData([width - BORDER_X                    , 0                             ], [BORDER_X                , BORDER_Y             ], [138, 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderTopLeft     = (width: number, height: number) => createUiSpriteData([0                                   , height - BORDER_Y             ], [BORDER_X                , BORDER_Y             ], [114, 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderTopRight    = (width: number, height: number) => createUiSpriteData([width - BORDER_X                    , height - BORDER_Y             ], [BORDER_X                , BORDER_Y             ], [90 , 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderBot         = (width: number, height: number) => createUiSpriteData([BORDER_X                            , 0                             ], [width - BORDER_X * 2    , BORDER_Y             ], [211, 272], [2       , BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderTop         = (width: number, height: number) => createUiSpriteData([BORDER_X                            , height - BORDER_Y             ], [width - BORDER_X * 2    , BORDER_Y             ], [211, 272], [2       , BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameCenter            = (width: number, height: number) => createUiSpriteData([BORDER_X                            , height - BORDER_Y - INFO_Y    ], [width - BORDER_X * 2    , INFO_Y               ], [96 , 160], [1       , 1       ]);\r\n/* prettier-ignore */ export const uiFrameBorderLeft        = (width: number, height: number) => createUiSpriteData([0                                   , BORDER_Y                      ], [BORDER_X                , height - BORDER_Y * 2], [186, 273], [BORDER_X, 2       ]);\r\n/* prettier-ignore */ export const uiFrameBorderRight       = (width: number, height: number) => createUiSpriteData([width - BORDER_X                    , BORDER_Y                      ], [BORDER_X                , height - BORDER_Y * 2], [186, 273], [BORDER_X, 2       ]);\r\n/* prettier-ignore */ export const uiFrameBorderCenterLeft  = (width: number, height: number) => createUiSpriteData([0                                   , height - BORDER_Y * 2 - INFO_Y], [BORDER_X                , BORDER_Y             ], [66 , 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderCenterRight = (width: number, height: number) => createUiSpriteData([width - BORDER_X                    , height - BORDER_Y * 2 - INFO_Y], [BORDER_X                , BORDER_Y             ], [42 , 272], [BORDER_X, BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameBorderCenter      = (width: number, height: number) => createUiSpriteData([BORDER_X                            , height - BORDER_Y * 2 - INFO_Y], [width - BORDER_X * 2    , BORDER_Y             ], [211, 272], [2       , BORDER_Y]);\r\n/* prettier-ignore */ export const uiFrameInfoLeft          = (width: number, height: number) => createUiSpriteData([BORDER_X + TEXT_PAD                 , textBlockOffsetY(height)      ], [TEXT_X                  , TEXT_Y               ], [0  , 192], [128     , 80      ]);\r\n/* prettier-ignore */ export const uiFrameInfoRight         = (width: number, height: number) => createUiSpriteData([width - BORDER_X - TEXT_X - TEXT_PAD, textBlockOffsetY(height)      ], [TEXT_X                  , TEXT_Y               ], [0  , 192], [128     , 80      ]);\r\n\r\nconst scrollPointWidthCenter = (width: number) => width / 2 - SCROLL_POINT_Y / 2;\r\nconst scrollPointHeightCenter = (height: number) => (height - BORDER_Y - INFO_Y) / 2 - SCROLL_POINT_Y / 2;\r\n/* prettier-ignore */ export const uiScrollLeftUvPos : Vec2 = [422, 272];\r\n/* prettier-ignore */ export const uiScrollRightUvPos: Vec2 = [454, 272];\r\n/* prettier-ignore */ export const uiScrollTopUvPos  : Vec2 = [0  , 352];\r\n/* prettier-ignore */ export const uiScrollBotUvPos  : Vec2 = [64 , 352];\r\n/* prettier-ignore */ export const uiScrollXUvSize   : Vec2 = [32 , 64 ];\r\n/* prettier-ignore */ export const uiScrollYUvSize   : Vec2 = [64 , 32 ];\r\n/* prettier-ignore */ export const uiScrollPointLeft  = (width: number, height: number) => createUiSpriteData([BORDER_X                         , scrollPointHeightCenter(height)            ], [SCROLL_POINT_X, SCROLL_POINT_Y], uiScrollLeftUvPos , uiScrollXUvSize);\r\n/* prettier-ignore */ export const uiScrollPointRight = (width: number, height: number) => createUiSpriteData([width - BORDER_X - SCROLL_POINT_X, scrollPointHeightCenter(height)            ], [SCROLL_POINT_X, SCROLL_POINT_Y], uiScrollRightUvPos, uiScrollXUvSize);\r\n/* prettier-ignore */ export const uiScrollPointTop   = (width: number, height: number) => createUiSpriteData([scrollPointWidthCenter(width)    , height - BORDER_Y - INFO_Y - SCROLL_POINT_Y], [SCROLL_POINT_Y, SCROLL_POINT_X], uiScrollTopUvPos  , uiScrollYUvSize);\r\n/* prettier-ignore */ export const uiScrollPointBot   = (width: number, height: number) => createUiSpriteData([scrollPointWidthCenter(width)    , BORDER_Y                                   ], [SCROLL_POINT_Y, SCROLL_POINT_X], uiScrollBotUvPos  , uiScrollYUvSize);\r\n\r\n/* prettier-ignore */ export const uiFacePos = (width: number, height: number) => [width / 2 - FACE_SIZE / 2, height - BORDER_Y - INFO_Y / 2 - FACE_SIZE / 2] as Vec2;\r\n/* prettier-ignore */ export const uiFaceDefaultUvPos: Vec2 = [214, 272];\r\n/* prettier-ignore */ export const uiFaceWinUvPos    : Vec2 = [370, 272];\r\n/* prettier-ignore */ export const uiFaceLoseUvPos   : Vec2 = [318, 272];\r\n/* prettier-ignore */ export const uiFacePressUvPos  : Vec2 = [266, 272];\r\n\r\nconst textOffsetY = (height: number) => height - TEXT_Y - BORDER_Y - TEXT_PAD + TEXT_SYM_OFF_Y;\r\n/* prettier-ignore */ export const uiTextMinesPos0 = (width: number, height: number) => [BORDER_X + TEXT_PAD + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 0                 , textOffsetY(height)] as Vec2;\r\n/* prettier-ignore */ export const uiTextMinesPos1 = (width: number, height: number) => [BORDER_X + TEXT_PAD + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 1                 , textOffsetY(height)] as Vec2;\r\n/* prettier-ignore */ export const uiTextMinesPos2 = (width: number, height: number) => [BORDER_X + TEXT_PAD + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 2                 , textOffsetY(height)] as Vec2;\r\n/* prettier-ignore */ export const uiTextTimePos0  = (width: number, height: number) => [width - BORDER_X - TEXT_PAD - TEXT_X + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 0, textOffsetY(height)] as Vec2;\r\n/* prettier-ignore */ export const uiTextTimePos1  = (width: number, height: number) => [width - BORDER_X - TEXT_PAD - TEXT_X + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 1, textOffsetY(height)] as Vec2;\r\n/* prettier-ignore */ export const uiTextTimePos2  = (width: number, height: number) => [width - BORDER_X - TEXT_PAD - TEXT_X + TEXT_SYM_OFF_X + (TEXT_SYM_X + TEXT_SYM_OFF_X) * 2, textOffsetY(height)] as Vec2;\r\n\r\nexport const uiTextMinesPosArray = [uiTextMinesPos0, uiTextMinesPos1, uiTextMinesPos2] as const;\r\nexport const uiTextTimePosArray = [uiTextTimePos0, uiTextTimePos1, uiTextTimePos2] as const;\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport { TFieldCameraState } from \"Game/IField\";\r\nimport {\r\n    createUiSpriteData,\r\n    GameUi,\r\n    IUi,\r\n    TEXT_ARRAY,\r\n    TUiSpriteData,\r\n    uiFrameBorderBot,\r\n    uiFrameBorderBotLeft,\r\n    uiFrameBorderBotRight,\r\n    uiFrameBorderTop,\r\n    uiFrameBorderTopLeft,\r\n    uiFrameBorderTopRight,\r\n    uiFrameCenter,\r\n    uiFrameBorderLeft,\r\n    uiFrameBorderRight,\r\n    uiFrameBorderCenterLeft,\r\n    uiFrameBorderCenterRight,\r\n    uiFrameBorderCenter,\r\n    uiFrameInfoLeft,\r\n    uiFrameInfoRight,\r\n    uiTextMinesPos0,\r\n    uiTextMinesPos1,\r\n    uiTextMinesPos2,\r\n    uiTextTimePos0,\r\n    uiTextTimePos1,\r\n    uiTextTimePos2,\r\n    uiFacePos,\r\n    uiScrollPointBot,\r\n    uiScrollPointTop,\r\n    uiScrollPointLeft,\r\n    uiScrollPointRight,\r\n    uiScrollYUvSize,\r\n    uiScrollXUvSize,\r\n    uiScrollBotUvPos,\r\n    uiScrollTopUvPos,\r\n    uiScrollRightUvPos,\r\n    uiScrollLeftUvPos,\r\n    uiFaceDefaultUvPos,\r\n    uiFaceWinUvPos,\r\n    uiFaceLoseUvPos,\r\n    uiFacePressUvPos,\r\n} from \"Game/IUi\";\r\nimport {\r\n    BORDER_Y,\r\n    BORDER_X,\r\n    FACE_SIZE,\r\n    INFO_Y,\r\n    TEXT_Y,\r\n    TEXT_SIZE,\r\n    TEXT_SYM_Y,\r\n    TEXT_SYM_OFF_X,\r\n    TEXT_SYM_OFF_Y,\r\n    TEXT_SYM_X,\r\n    TEXT_X,\r\n    SCROLL_POINT_Y,\r\n    SCROLL_POINT_X,\r\n    TEXTURE_SIZE,\r\n    TEXT_PAD,\r\n    TEXT_SYM_SIZE,\r\n} from \"Game/Constants\";\r\n\r\nimport { createWebGpuBufferDynamic, createWebGpuBufferWithData } from \"WebGpu/WebGpuBuffer\";\r\nimport { createWebGpuTexture } from \"WebGpu/WebGpuTexture\";\r\nimport { createOrthographicMatrix } from \"WebGpu/Matrices\";\r\nimport { gWebGpuInstance } from \"WebGpu/WebGpuInstance\";\r\n\r\nimport { Vec2 } from \"Types\";\r\nimport { getTheme } from \"Theme\";\r\n\r\nimport vertShaderCode from \"assets/shaders/ui.vert.wgsl\";\r\nimport fragShaderCode from \"assets/shaders/ui.frag.wgsl\";\r\n\r\ninterface TDrawData {\r\n    pipeline: GPURenderPipeline;\r\n    staticPositionBuffer: GPUBuffer;\r\n    staticTextureCoordBuffer: GPUBuffer;\r\n    staticIndicesBuffer: GPUBuffer;\r\n    dynamicPositionBuffer: GPUBuffer;\r\n    dynamicTextureCoordBuffer: GPUBuffer;\r\n    dynamicIndicesBuffer: GPUBuffer;\r\n    uiTextureUniformBindGroupDark: GPUBindGroup;\r\n    uiTextureUniformBindGroupLight: GPUBindGroup;\r\n    uiMatricesUniformBindGroup: GPUBindGroup;\r\n}\r\n\r\nconst getPos = (position: Vec2, size: Vec2) => {\r\n    const x = position[0];\r\n    const y = position[1];\r\n    const width = size[0];\r\n    const height = size[1];\r\n\r\n    return [\r\n        [x, y],\r\n        [x + width, y],\r\n        [x, y + height],\r\n        [x + width, y + height],\r\n    ];\r\n};\r\n\r\nconst getUV = (position: Vec2, size: Vec2) => {\r\n    const x = position[0] / TEXTURE_SIZE;\r\n    const y = position[1] / TEXTURE_SIZE;\r\n    const width = size[0] / TEXTURE_SIZE;\r\n    const height = size[1] / TEXTURE_SIZE;\r\n\r\n    return [\r\n        [x, y + height],\r\n        [x + width, y + height],\r\n        [x, y],\r\n        [x + width, y],\r\n    ];\r\n};\r\n\r\nconst genVBOs = (sprites: TUiSpriteData[]) => {\r\n    const positions: number[] = [];\r\n    const uvs: number[] = [];\r\n    const indices: number[] = [];\r\n\r\n    let index = 0;\r\n    for (const sprite of sprites) {\r\n        const pos = getPos(sprite.spritePos, sprite.spriteSize);\r\n        const uv = getUV(sprite.atlasPos, sprite.atlasSize);\r\n\r\n        positions.push(...pos.flat());\r\n        uvs.push(...uv.flat());\r\n\r\n        indices.push(index, index + 1, index + 2, index + 1, index + 2, index + 3);\r\n        index += 4;\r\n    }\r\n\r\n    return { positions, uvs, indices };\r\n};\r\n\r\nexport class WebGpuUi extends GameUi implements IUi {\r\n    private device: GPUDevice | null = null;\r\n\r\n    private drawData: TDrawData | null = null;\r\n\r\n    private staticIndicesCount = 0;\r\n    private dynamicIndicesCount = 0;\r\n\r\n    async init(width: number, height: number) {\r\n        if (!gWebGpuInstance) {\r\n            throw new Error(\"WebGpuInstance is not initialized\");\r\n        }\r\n\r\n        this.baseInit(width, height);\r\n\r\n        this.device = gWebGpuInstance.getDevice();\r\n\r\n        // prettier-ignore\r\n        const { positions: staticPositions, uvs: staticUVs, indices: staticIndices } = genVBOs([\r\n            uiFrameBorderBotLeft(width, height),\r\n            uiFrameBorderBotRight(width, height),\r\n            uiFrameBorderTopLeft(width, height),\r\n            uiFrameBorderTopRight(width, height),\r\n            uiFrameBorderBot(width, height),\r\n            uiFrameBorderTop(width, height),\r\n            uiFrameCenter(width, height),\r\n            uiFrameBorderLeft(width, height),\r\n            uiFrameBorderRight(width, height),\r\n            uiFrameBorderCenterLeft(width, height),\r\n            uiFrameBorderCenterRight(width, height),\r\n            uiFrameBorderCenter(width, height),\r\n            uiFrameInfoLeft(width, height),\r\n            uiFrameInfoRight(width, height),\r\n        ]);\r\n\r\n        const staticPositionBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            staticPositions,\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const staticTextureCoordBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            staticUVs,\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const staticIndicesBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            staticIndices,\r\n            Uint32Array,\r\n            GPUBufferUsage.INDEX\r\n        );\r\n\r\n        this.staticIndicesCount = staticIndices.length;\r\n\r\n        const faceOffsetY = height - BORDER_Y - INFO_Y / 2 - FACE_SIZE / 2;\r\n\r\n        // prettier-ignore\r\n        const { positions: dynamicPositions, uvs: dynamicUVs, indices: dynamicIndices, } = genVBOs([\r\n            createUiSpriteData(uiTextMinesPos0(width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiTextMinesPos1(width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiTextMinesPos2(width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiTextTimePos0 (width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiTextTimePos1 (width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiTextTimePos2 (width, height), TEXT_SYM_SIZE         , [0, 0], [0,0]),\r\n            createUiSpriteData(uiFacePos      (width, height), [FACE_SIZE, FACE_SIZE], [0, 0], [0,0]),\r\n            uiScrollPointBot(width, height),\r\n            uiScrollPointTop(width, height),\r\n            uiScrollPointLeft(width, height),\r\n            uiScrollPointRight(width, height),\r\n        ]);\r\n\r\n        const dynamicPositionBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            dynamicPositions,\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const dynamicTextureCoordBuffer = createWebGpuBufferDynamic(\r\n            this.device,\r\n            dynamicUVs.length * Float32Array.BYTES_PER_ELEMENT,\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const dynamicIndicesBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            dynamicIndices,\r\n            Uint32Array,\r\n            GPUBufferUsage.INDEX\r\n        );\r\n\r\n        this.dynamicIndicesCount = dynamicIndices.length;\r\n\r\n        const vsmDesc = { code: vertShaderCode };\r\n        const vertModule = this.device.createShaderModule(vsmDesc);\r\n\r\n        const fsmDesc = { code: fragShaderCode };\r\n        const fragModule = this.device.createShaderModule(fsmDesc);\r\n\r\n        const positionAttribDesc: GPUVertexAttribute = {\r\n            shaderLocation: 0,\r\n            offset: 0,\r\n            format: \"float32x2\",\r\n        };\r\n        const positionBufferDesc: GPUVertexBufferLayout = {\r\n            attributes: [positionAttribDesc],\r\n            arrayStride: 4 * 2, // sizeof(float) * 2\r\n            stepMode: \"vertex\",\r\n        };\r\n\r\n        const textureCoordAttribDesc: GPUVertexAttribute = {\r\n            shaderLocation: 1,\r\n            offset: 0,\r\n            format: \"float32x2\",\r\n        };\r\n        const textureCoordBufferDesc: GPUVertexBufferLayout = {\r\n            attributes: [textureCoordAttribDesc],\r\n            arrayStride: 4 * 2, // sizeof(float) * 2\r\n            stepMode: \"vertex\",\r\n        };\r\n\r\n        const uiTextureBindGroupLayout: GPUBindGroupLayout = this.device.createBindGroupLayout({\r\n            entries: [\r\n                { binding: 0, visibility: GPUShaderStage.FRAGMENT, sampler: {} },\r\n                { binding: 1, visibility: GPUShaderStage.FRAGMENT, texture: {} },\r\n            ],\r\n        });\r\n\r\n        const uiMatricesBindGroupLayout: GPUBindGroupLayout = this.device.createBindGroupLayout({\r\n            entries: [{ binding: 0, visibility: GPUShaderStage.VERTEX, buffer: {} }],\r\n        });\r\n\r\n        const pipelineLayoutDesc: GPUPipelineLayoutDescriptor = {\r\n            bindGroupLayouts: [uiTextureBindGroupLayout, uiMatricesBindGroupLayout],\r\n        };\r\n        const pipelineLayout = this.device.createPipelineLayout(pipelineLayoutDesc);\r\n\r\n        const vertex: GPUVertexState = {\r\n            module: vertModule,\r\n            entryPoint: \"main\",\r\n            buffers: [positionBufferDesc, textureCoordBufferDesc],\r\n        };\r\n\r\n        const presentationFormat: GPUColorTargetState = {\r\n            format: \"bgra8unorm\",\r\n            blend: {\r\n                color: { srcFactor: \"one\", dstFactor: \"one-minus-src-alpha\" },\r\n                alpha: { srcFactor: \"one\", dstFactor: \"one-minus-src-alpha\" },\r\n            },\r\n        };\r\n        const fragment: GPUFragmentState = {\r\n            module: fragModule,\r\n            entryPoint: \"main\",\r\n            targets: [presentationFormat],\r\n        };\r\n\r\n        const pipelineDesc: GPURenderPipelineDescriptor = {\r\n            label: \"ui-pipeline\",\r\n            layout: pipelineLayout,\r\n\r\n            vertex,\r\n            fragment,\r\n\r\n            // primitive,\r\n        };\r\n        const pipeline = this.device.createRenderPipeline(pipelineDesc);\r\n\r\n        const sampler = this.device.createSampler({\r\n            magFilter: \"nearest\",\r\n            minFilter: \"nearest\",\r\n            mipmapFilter: \"nearest\",\r\n        });\r\n\r\n        const uiTextureDark = await createWebGpuTexture(this.device, \"./assets/textures/field_atlas_dark.png\");\r\n        const uiTextureUniformBindGroupDark = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(0),\r\n            entries: [\r\n                { binding: 0, resource: sampler },\r\n                { binding: 1, resource: uiTextureDark.createView() },\r\n            ],\r\n        });\r\n\r\n        const uiTextureLight = await createWebGpuTexture(this.device, \"./assets/textures/field_atlas_light.png\");\r\n        const uiTextureUniformBindGroupLight = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(0),\r\n            entries: [\r\n                { binding: 0, resource: sampler },\r\n                { binding: 1, resource: uiTextureLight.createView() },\r\n            ],\r\n        });\r\n\r\n        const uiMatricesBuffer = createWebGpuBufferDynamic(this.device, 4 * 4, Float32Array, GPUBufferUsage.UNIFORM);\r\n        this.device.queue.writeBuffer(uiMatricesBuffer, 0, createOrthographicMatrix(0, width, 0, height, -1, 1));\r\n\r\n        const uiMatricesUniformBindGroup = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(1),\r\n            entries: [{ binding: 0, resource: { buffer: uiMatricesBuffer } }],\r\n        });\r\n\r\n        this.drawData = {\r\n            pipeline,\r\n            staticPositionBuffer,\r\n            staticIndicesBuffer,\r\n            staticTextureCoordBuffer,\r\n            dynamicPositionBuffer,\r\n            dynamicIndicesBuffer,\r\n            dynamicTextureCoordBuffer,\r\n            uiMatricesUniformBindGroup,\r\n            uiTextureUniformBindGroupDark,\r\n            uiTextureUniformBindGroupLight,\r\n        };\r\n    }\r\n\r\n    update(gameLogic: GameLogic, fieldCameraState: TFieldCameraState, gameWindow: GameWindow) {\r\n        if (!this.device) {\r\n            throw new Error(\"WebGpuUi is not initialized\");\r\n        }\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuUi drawData in not created!\");\r\n        }\r\n\r\n        const closedMines = Math.min(gameLogic.getClosedAndNotMarkedMinesCount(), 999);\r\n\r\n        const dynamicTextureCoordBufferData = new Float32Array(11 * 4 * 2);\r\n\r\n        const minesSlice = [Math.floor(closedMines / 100) % 10, Math.floor(closedMines / 10) % 10, closedMines % 10];\r\n        for (let i = 0; i < 3; i++) {\r\n            const text = TEXT_ARRAY[minesSlice[i]];\r\n            dynamicTextureCoordBufferData.set(getUV(text, TEXT_SIZE).flat(), i * 4 * 2);\r\n        }\r\n\r\n        const seconds = Math.min(gameLogic.getSecondsFromStart(), 999);\r\n        const secondsSlice = [Math.floor(seconds / 100) % 10, Math.floor(seconds / 10) % 10, seconds % 10];\r\n        for (let i = 3; i < 6; i++) {\r\n            const text = TEXT_ARRAY[secondsSlice[i - 3]];\r\n            dynamicTextureCoordBufferData.set(getUV(text, TEXT_SIZE).flat(), i * 4 * 2);\r\n        }\r\n\r\n        if (this.isMouseInsideFace(gameWindow) && this.mouseOnFaceDown) {\r\n            dynamicTextureCoordBufferData.set(getUV(uiFacePressUvPos, [FACE_SIZE, FACE_SIZE]).flat(), 6 * 4 * 2);\r\n        } else if (gameLogic.isGameOver()) {\r\n            dynamicTextureCoordBufferData.set(getUV(uiFaceLoseUvPos, [FACE_SIZE, FACE_SIZE]).flat(), 6 * 4 * 2);\r\n        } else if (gameLogic.isGameWin()) {\r\n            dynamicTextureCoordBufferData.set(getUV(uiFaceWinUvPos, [FACE_SIZE, FACE_SIZE]).flat(), 6 * 4 * 2);\r\n        } else {\r\n            dynamicTextureCoordBufferData.set(getUV(uiFaceDefaultUvPos, [FACE_SIZE, FACE_SIZE]).flat(), 6 * 4 * 2);\r\n        }\r\n\r\n        // console.log(fieldCameraState);\r\n        dynamicTextureCoordBufferData.set(\r\n            !fieldCameraState.isOnBottom\r\n                ? getUV(uiScrollBotUvPos, uiScrollYUvSize).flat()\r\n                : getUV([500, 500], [1, 1]).flat(),\r\n            7 * 4 * 2\r\n        );\r\n        dynamicTextureCoordBufferData.set(\r\n            !fieldCameraState.isOnTop\r\n                ? getUV(uiScrollTopUvPos, uiScrollYUvSize).flat()\r\n                : getUV([500, 500], [1, 1]).flat(),\r\n            8 * 4 * 2\r\n        );\r\n        dynamicTextureCoordBufferData.set(\r\n            !fieldCameraState.isOnLeft\r\n                ? getUV(uiScrollLeftUvPos, uiScrollXUvSize).flat()\r\n                : getUV([500, 500], [1, 1]).flat(),\r\n            9 * 4 * 2\r\n        );\r\n        dynamicTextureCoordBufferData.set(\r\n            !fieldCameraState.isOnRight\r\n                ? getUV(uiScrollRightUvPos, uiScrollXUvSize).flat()\r\n                : getUV([500, 500], [1, 1]).flat(),\r\n            10 * 4 * 2\r\n        );\r\n\r\n        this.device.queue.writeBuffer(this.drawData.dynamicTextureCoordBuffer, 0, dynamicTextureCoordBufferData);\r\n    }\r\n\r\n    draw() {\r\n        if (!gWebGpuInstance) {\r\n            throw new Error(\"WebGpuInstance is not initialized\");\r\n        }\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuField drawData in not created!\");\r\n        }\r\n\r\n        const passEncoder = gWebGpuInstance?.getPassEncoder();\r\n\r\n        passEncoder.setPipeline(this.drawData.pipeline);\r\n        passEncoder.setViewport(0, 0, this.windowWidth, this.windowHeight, 0, 1);\r\n        passEncoder.setScissorRect(0, 0, this.windowWidth, this.windowHeight);\r\n\r\n        if (getTheme() === \"dark\") {\r\n            passEncoder.setBindGroup(0, this.drawData.uiTextureUniformBindGroupDark);\r\n        } else {\r\n            passEncoder.setBindGroup(0, this.drawData.uiTextureUniformBindGroupLight);\r\n        }\r\n        passEncoder.setBindGroup(1, this.drawData.uiMatricesUniformBindGroup);\r\n\r\n        passEncoder.setVertexBuffer(0, this.drawData.staticPositionBuffer);\r\n        passEncoder.setVertexBuffer(1, this.drawData.staticTextureCoordBuffer);\r\n        passEncoder.setIndexBuffer(this.drawData.staticIndicesBuffer, \"uint32\");\r\n\r\n        passEncoder.drawIndexed(this.staticIndicesCount, 1, 0, 0, 0);\r\n\r\n        passEncoder.setVertexBuffer(0, this.drawData.dynamicPositionBuffer);\r\n        passEncoder.setVertexBuffer(1, this.drawData.dynamicTextureCoordBuffer);\r\n        passEncoder.setIndexBuffer(this.drawData.dynamicIndicesBuffer, \"uint32\");\r\n\r\n        passEncoder.drawIndexed(this.dynamicIndicesCount, 1, 0, 0, 0);\r\n    }\r\n}\r\n","import { IRendererInstance } from \"Game/IRendererInstance\";\r\n\r\nexport class HtmlCanvasInstance implements IRendererInstance {\r\n    private canvas: HTMLCanvasElement | null = null;\r\n    private context: CanvasRenderingContext2D | null = null;\r\n\r\n    constructor() {}\r\n\r\n    async init(canvas: HTMLCanvasElement) {\r\n        this.canvas = canvas;\r\n        this.context = this.canvas.getContext(\"2d\");\r\n\r\n        gHtmlCanvasInstance = this;\r\n    }\r\n\r\n    getContext(): CanvasRenderingContext2D {\r\n        if (!this.context) {\r\n            throw new Error(\"HtmlCanvasInstance is not initialized\");\r\n        }\r\n\r\n        return this.context;\r\n    }\r\n\r\n    beginFrame() {\r\n        if (!this.canvas || !this.context) {\r\n            throw new Error(\"HtmlCanvasInstance is not initialized\");\r\n        }\r\n\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    endFrame() {}\r\n}\r\n\r\nexport let gHtmlCanvasInstance: HtmlCanvasInstance | null = null;\r\n","export const createHtmlCanvasTexture = (filename: string): Promise<HTMLImageElement> => {\r\n    return new Promise((resolve, reject) => {\r\n        const img = new Image();\r\n        img.onload = () => resolve(img);\r\n        img.onerror = reject;\r\n        img.src = filename;\r\n    });\r\n};\r\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!./styles.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!./styles.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { GameLogic } from \"Game/GameLogic\";\r\nimport { GameWindow } from \"GameWidnow\";\r\nimport { calcCanvasSize } from \"Game/Utils\";\r\nimport { IRendererInstanceConstructor } from \"Game/IRendererInstance\";\r\nimport { IFieldConstructor } from \"Game/IField\";\r\n\r\nimport { GameDataBase, getRendererType, getStartupInputs, startNewGame, switchRendererType } from \"FieldSerializer\";\r\n\r\nimport { WebGpuInstance } from \"WebGpu/WebGpuInstance\";\r\nimport { WebGpuField } from \"WebGpu/WebGpuField\";\r\nimport { WebGpuUi } from \"WebGpu/WebGpuUi\";\r\n\r\nimport { HtmlCanvasInstance } from \"HtmlCanvas/HtmlCanvasInstance\";\r\nimport { HtmlCanvasField } from \"HtmlCanvas/HtmlCanvasField\";\r\nimport { HtmlCanvasUi } from \"HtmlCanvas/HtmlCanvasUi\";\r\n\r\nimport { detectColorScheme, getTheme } from \"Theme\";\r\n\r\nimport \"./styles.css\";\r\nimport { IUiConstructor } from \"Game/IUi\";\r\n\r\nconst THEME_DARK_ICON = \"./assets/img/theme_dark.png\";\r\nconst THEME_LIGHT_ICON = \"./assets/img/theme_light.png\";\r\n\r\nlet InstanceType: IRendererInstanceConstructor = HtmlCanvasInstance;\r\nlet FieldType: IFieldConstructor = HtmlCanvasField;\r\nlet UiType: IUiConstructor = HtmlCanvasUi;\r\n\r\nconst rendererType = getRendererType();\r\n\r\nif (rendererType === \"webgpu\") {\r\n    InstanceType = WebGpuInstance;\r\n    FieldType = WebGpuField;\r\n    UiType = WebGpuUi;\r\n\r\n    document.getElementById(\"renderer-text\")!.innerHTML = \"WebGPU\";\r\n} else {\r\n    document.getElementById(\"renderer-text\")!.innerHTML = \"Canvas\";\r\n}\r\n\r\ndocument.getElementById(\"renderer-switch\")?.addEventListener(\"click\", () => {\r\n    switchRendererType();\r\n});\r\n\r\ndetectColorScheme();\r\n\r\nconst themeToggleSwitch = document.querySelector('#theme-switch input[type=\"checkbox\"]') as HTMLInputElement;\r\nconst themeIcon = document.querySelector(\"#theme-switch img\") as HTMLImageElement;\r\n\r\nfunction switchTheme(e: Event) {\r\n    const target = e.target as HTMLInputElement;\r\n    if (target.checked) {\r\n        localStorage.setItem(\"theme\", \"dark\");\r\n        document.documentElement.setAttribute(\"data-theme\", \"dark\");\r\n        themeToggleSwitch.checked = true;\r\n        themeIcon.src = THEME_DARK_ICON;\r\n    } else {\r\n        localStorage.setItem(\"theme\", \"light\");\r\n        document.documentElement.setAttribute(\"data-theme\", \"light\");\r\n        themeToggleSwitch.checked = false;\r\n        themeIcon.src = THEME_LIGHT_ICON;\r\n    }\r\n}\r\n\r\nthemeToggleSwitch.addEventListener(\"change\", switchTheme, false);\r\n\r\ndocument.getElementById(\"form-field\")?.addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n\r\n    const formData = new FormData(document.getElementById(\"form-field\") as HTMLFormElement);\r\n    const cols = parseInt((formData.get(\"cols\") as string) || \"0\");\r\n    const rows = parseInt((formData.get(\"rows\") as string) || \"0\");\r\n    const mines = parseInt((formData.get(\"mines\") as string) || \"0\");\r\n    if (!cols || !rows || !mines) {\r\n        return;\r\n    }\r\n\r\n    if (mines >= cols * rows) {\r\n        document.getElementById(\"error-message\")!.innerHTML = \"Mines count must be less than field size\";\r\n        return;\r\n    }\r\n\r\n    startNewGame(cols, rows, mines);\r\n});\r\ndocument.getElementById(\"new-game-beginner\")?.addEventListener(\"click\", () => {\r\n    startNewGame(\"9\", \"9\", \"10\");\r\n});\r\ndocument.getElementById(\"new-game-intermediate\")?.addEventListener(\"click\", () => {\r\n    startNewGame(\"16\", \"16\", \"40\");\r\n});\r\ndocument.getElementById(\"new-game-expert\")?.addEventListener(\"click\", () => {\r\n    startNewGame(\"30\", \"16\", \"99\");\r\n});\r\ndocument.getElementById(\"load-game\")?.addEventListener(\"click\", () => {\r\n    window.location.href = \"?load=true\";\r\n});\r\n\r\nif (getTheme() == \"dark\") {\r\n    themeToggleSwitch.checked = true;\r\n    themeIcon.src = \"assets/img/theme_dark.png\";\r\n} else {\r\n    themeToggleSwitch.checked = false;\r\n    themeIcon.src = \"assets/img/theme_light.png\";\r\n}\r\n\r\nconst { cols, rows, mines, load } = getStartupInputs();\r\n\r\nconst gameLogic = new GameLogic([cols, rows], mines);\r\n\r\nconst start = async () => {\r\n    const { width: canvasWidth, height: canvasHeight } = calcCanvasSize(\r\n        gameLogic.getFieldColSize(),\r\n        gameLogic.getFieldRowSize()\r\n    );\r\n    const canvas = document.getElementById(\"app\") as HTMLCanvasElement;\r\n    canvas.width = canvasWidth;\r\n    canvas.height = canvasHeight;\r\n\r\n    const instance = new InstanceType();\r\n    const gameWindow = new GameWindow(canvas);\r\n\r\n    let frame = 0;\r\n    await instance.init(canvas);\r\n\r\n    const field = new FieldType();\r\n    await field.init(canvas.width, canvas.height);\r\n\r\n    const ui = new UiType();\r\n    await ui.init(canvas.width, canvas.height);\r\n\r\n    gameWindow.setOnMouseButtonUp((button) => {\r\n        if (button === 0) {\r\n            const hoveredCell = field.getHoveredCell(gameWindow);\r\n            if (field.isMouseInside(gameWindow) && gameLogic.isCellExists(hoveredCell.col, hoveredCell.row)) {\r\n                gameLogic.openCell(hoveredCell.col, hoveredCell.row);\r\n            }\r\n            ui.checkFaceClickUp(gameLogic, gameWindow);\r\n        }\r\n    });\r\n    gameWindow.setOnMouseButtonDown((button) => {\r\n        if (button === 0) {\r\n            ui.checkFaceClickDown(gameWindow);\r\n        }\r\n        if (button === 2) {\r\n            const hoveredCell = field.getHoveredCell(gameWindow);\r\n            if (gameLogic.isCellExists(hoveredCell.col, hoveredCell.row)) {\r\n                gameLogic.markCell(hoveredCell.col, hoveredCell.row);\r\n            }\r\n        }\r\n    });\r\n    gameWindow.setOnWheel((x, y) => {\r\n        field.moveCamera(gameLogic, x, y);\r\n    });\r\n\r\n    const render = () => {\r\n        frame++;\r\n\r\n        gameLogic.update();\r\n        field.update(gameLogic, gameWindow);\r\n        ui.update(gameLogic, field.getFieldCameraState(gameLogic), gameWindow);\r\n\r\n        instance.beginFrame();\r\n\r\n        field.draw();\r\n        ui.draw();\r\n\r\n        instance.endFrame();\r\n\r\n        requestAnimationFrame(render);\r\n    };\r\n\r\n    requestAnimationFrame(render);\r\n};\r\n\r\nconst gameDataBase = new GameDataBase(\r\n    () => {\r\n        document.getElementById(\"save-game\")?.addEventListener(\"click\", () => {\r\n            gameDataBase.saveGame(gameLogic);\r\n        });\r\n\r\n        if (load) {\r\n            gameDataBase.loadGame(\r\n                gameLogic,\r\n                () => {\r\n                    document\r\n                        .getElementById(\"field-cols\")\r\n                        ?.setAttribute(\"value\", gameLogic.getFieldColSize().toString());\r\n                    document\r\n                        .getElementById(\"field-rows\")\r\n                        ?.setAttribute(\"value\", gameLogic.getFieldRowSize().toString());\r\n                    document\r\n                        .getElementById(\"field-mines\")\r\n                        ?.setAttribute(\"value\", gameLogic.getFieldMinesCount().toString());\r\n\r\n                    const params = new URLSearchParams(window.location.search);\r\n                    params.delete(\"load\");\r\n                    console.log(params.toString());\r\n                    history.replaceState(null, \"\", \"?\" + params.toString());\r\n\r\n                    start();\r\n                },\r\n                () => {\r\n                    document.getElementById(\"error-message\")!.innerHTML = \"Error loading game\";\r\n                }\r\n            );\r\n        }\r\n    },\r\n    () => {\r\n        if (load) {\r\n            document.getElementById(\"error-message\")!.innerHTML = \"Error loading game\";\r\n        }\r\n    }\r\n);\r\n\r\nif (!load) {\r\n    document.getElementById(\"field-cols\")?.setAttribute(\"value\", cols.toString());\r\n    document.getElementById(\"field-rows\")?.setAttribute(\"value\", rows.toString());\r\n    document.getElementById(\"field-mines\")?.setAttribute(\"value\", mines.toString());\r\n\r\n    gameLogic.generateField();\r\n\r\n    start();\r\n}\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport { GameField, IField } from \"Game/IField\";\r\nimport { CAMERA_OFFSET_X, CAMERA_OFFSET_Y, FIELD_CELL_SIZE } from \"Game/Constants\";\r\n\r\nimport { gHtmlCanvasInstance } from \"HtmlCanvas/HtmlCanvasInstance\";\r\nimport { createHtmlCanvasTexture } from \"HtmlCanvas/HtmlCanvasTexture\";\r\n\r\nimport { getTheme } from \"Theme\";\r\nimport { Vec2 } from \"Types\";\r\n\r\ninterface TDrawData {\r\n    uiTextureDark: HTMLImageElement;\r\n    uiTextureLight: HTMLImageElement;\r\n}\r\n\r\nexport class HtmlCanvasField extends GameField implements IField {\r\n    private context: CanvasRenderingContext2D | null = null;\r\n\r\n    private drawData: TDrawData | null = null;\r\n\r\n    private textureIdArray: Uint8Array = new Uint8Array(0);\r\n\r\n    async init(width: number, height: number) {\r\n        if (!gHtmlCanvasInstance) {\r\n            throw new Error(\"HtmlCanvasInstance is not initialized\");\r\n        }\r\n\r\n        this.baseInit(width, height);\r\n\r\n        this.context = gHtmlCanvasInstance.getContext();\r\n\r\n        const { maxDrawColCount, maxDrawRowCount } = this.getMaxFieldRowAndColCount(\r\n            this.windowWidth,\r\n            this.windowHeight\r\n        );\r\n        this.textureIdArray = new Uint8Array(maxDrawColCount * maxDrawRowCount);\r\n\r\n        const uiTextureDark = await createHtmlCanvasTexture(\"./assets/textures/field_atlas_dark.png\");\r\n        const uiTextureLight = await createHtmlCanvasTexture(\"./assets/textures/field_atlas_light.png\");\r\n\r\n        this.drawData = {\r\n            uiTextureDark,\r\n            uiTextureLight,\r\n        };\r\n    }\r\n\r\n    update(gameLogic: GameLogic, gameWindow: GameWindow) {\r\n        const { maxDrawColCount, maxDrawRowCount } = this.getMaxFieldRowAndColCount(\r\n            this.windowWidth,\r\n            this.windowHeight\r\n        );\r\n        const { col: hoveredCellCol, row: hoveredCellRow } = this.getHoveredCell(gameWindow);\r\n\r\n        const isMouseInside = this.isMouseInside(gameWindow);\r\n        const isLeftMouseButtonPressed = gameWindow.isMouseButtonPressed(0);\r\n        const isHoveredCellOpened =\r\n            gameLogic.isCellExists(hoveredCellCol, hoveredCellRow) &&\r\n            gameLogic.isCellOpened(hoveredCellCol, hoveredCellRow);\r\n\r\n        const textureIdBufferColOffset = Math.ceil(this.cameraPosition.x / FIELD_CELL_SIZE);\r\n        const textureIdBufferRowOffset = Math.ceil(this.cameraPosition.y / FIELD_CELL_SIZE);\r\n        for (let i = 0; i < maxDrawRowCount * maxDrawColCount; i++) {\r\n            const row = Math.floor(i / maxDrawColCount) - textureIdBufferRowOffset;\r\n            const col = (i % maxDrawColCount) - textureIdBufferColOffset;\r\n\r\n            const isPressed =\r\n                gameLogic.isGamePlaying() &&\r\n                isMouseInside &&\r\n                isLeftMouseButtonPressed &&\r\n                ((hoveredCellCol === col && hoveredCellRow === row) ||\r\n                    (isHoveredCellOpened &&\r\n                        Math.abs(hoveredCellCol - col) <= 1 &&\r\n                        Math.abs(hoveredCellRow - row) <= 1));\r\n            this.textureIdArray[i] = this.getFieldTextureId(gameLogic, col, row, isPressed);\r\n        }\r\n    }\r\n\r\n    private drawRect(pos: Vec2, textureId: number) {\r\n        if (!this.context) {\r\n            throw new Error(\"HtmlCanvasUi is not initialized\");\r\n        }\r\n\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuUi drawData in not created!\");\r\n        }\r\n\r\n        const texture = getTheme() === \"dark\" ? this.drawData.uiTextureDark : this.drawData.uiTextureLight;\r\n\r\n        const atlasPos = [(textureId % 8) * FIELD_CELL_SIZE * 2, Math.floor(textureId / 8) * FIELD_CELL_SIZE * 2];\r\n\r\n        this.context.drawImage(\r\n            texture,\r\n            atlasPos[0],\r\n            atlasPos[1],\r\n            FIELD_CELL_SIZE * 2,\r\n            FIELD_CELL_SIZE * 2,\r\n            pos[0],\r\n            this.windowHeight - pos[1] - FIELD_CELL_SIZE,\r\n            FIELD_CELL_SIZE,\r\n            FIELD_CELL_SIZE\r\n        );\r\n    }\r\n\r\n    draw() {\r\n        const offsetX = CAMERA_OFFSET_X + (this.cameraPosition.x % FIELD_CELL_SIZE);\r\n        const offsetY = CAMERA_OFFSET_Y + (this.cameraPosition.y % FIELD_CELL_SIZE);\r\n\r\n        const { maxDrawColCount, maxDrawRowCount } = this.getMaxFieldRowAndColCount(\r\n            this.windowWidth,\r\n            this.windowHeight\r\n        );\r\n\r\n        for (let i = 0; i < maxDrawRowCount * maxDrawColCount; i++) {\r\n            const row = Math.floor(i / maxDrawColCount);\r\n            const col = i % maxDrawColCount;\r\n            this.drawRect([col * FIELD_CELL_SIZE + offsetX, row * FIELD_CELL_SIZE + offsetY], this.textureIdArray[i]);\r\n        }\r\n    }\r\n}\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport { TFieldCameraState } from \"Game/IField\";\r\nimport {\r\n    createUiSpriteData,\r\n    GameUi,\r\n    IUi,\r\n    TEXT_ARRAY,\r\n    TUiSpriteData,\r\n    uiFrameBorderBot,\r\n    uiFrameBorderBotLeft,\r\n    uiFrameBorderBotRight,\r\n    uiFrameBorderTop,\r\n    uiFrameBorderTopLeft,\r\n    uiFrameBorderTopRight,\r\n    uiFrameCenter,\r\n    uiFrameBorderLeft,\r\n    uiFrameBorderRight,\r\n    uiFrameBorderCenterLeft,\r\n    uiFrameBorderCenterRight,\r\n    uiFrameBorderCenter,\r\n    uiFrameInfoLeft,\r\n    uiFrameInfoRight,\r\n    uiTextMinesPosArray,\r\n    uiTextTimePosArray,\r\n    uiFaceDefaultUvPos,\r\n    uiFacePressUvPos,\r\n    uiFaceWinUvPos,\r\n    uiFaceLoseUvPos,\r\n    uiFacePos,\r\n    uiScrollPointTop,\r\n    uiScrollPointLeft,\r\n    uiScrollPointRight,\r\n    uiScrollPointBot,\r\n} from \"Game/IUi\";\r\n\r\nimport { gHtmlCanvasInstance } from \"HtmlCanvas/HtmlCanvasInstance\";\r\nimport { Vec2 } from \"Types\";\r\nimport { createHtmlCanvasTexture } from \"./HtmlCanvasTexture\";\r\n\r\nimport { getTheme } from \"Theme\";\r\nimport { FACE_SIZE, TEXT_SIZE, TEXT_SYM_SIZE } from \"Game/Constants\";\r\n\r\ntype TFaceState = \"default\" | \"press\" | \"win\" | \"lose\";\r\n\r\ninterface TDrawData {\r\n    uiTextureDark: HTMLImageElement;\r\n    uiTextureLight: HTMLImageElement;\r\n}\r\n\r\nexport class HtmlCanvasUi extends GameUi implements IUi {\r\n    private context: CanvasRenderingContext2D | null = null;\r\n\r\n    private drawData: TDrawData | null = null;\r\n\r\n    private closedMines: number = 0;\r\n    private seconds: number = 0;\r\n\r\n    private faceState: TFaceState = \"default\";\r\n\r\n    private fieldCameraState: TFieldCameraState = {\r\n        isOnBottom: false,\r\n        isOnLeft: false,\r\n        isOnRight: false,\r\n        isOnTop: false,\r\n    };\r\n\r\n    async init(width: number, height: number) {\r\n        if (!gHtmlCanvasInstance) {\r\n            throw new Error(\"HtmlCanvasInstance is not initialized\");\r\n        }\r\n\r\n        this.baseInit(width, height);\r\n\r\n        this.context = gHtmlCanvasInstance.getContext();\r\n\r\n        const uiTextureDark = await createHtmlCanvasTexture(\"./assets/textures/field_atlas_dark.png\");\r\n        const uiTextureLight = await createHtmlCanvasTexture(\"./assets/textures/field_atlas_light.png\");\r\n\r\n        this.drawData = {\r\n            uiTextureDark,\r\n            uiTextureLight,\r\n        };\r\n    }\r\n\r\n    update(gameLogic: GameLogic, fieldCameraState: TFieldCameraState, gameWindow: GameWindow) {\r\n        this.closedMines = Math.min(gameLogic.getClosedAndNotMarkedMinesCount(), 999);\r\n        this.seconds = Math.min(gameLogic.getSecondsFromStart(), 999);\r\n        this.fieldCameraState = fieldCameraState;\r\n\r\n        this.faceState = \"default\";\r\n        if (this.isMouseInsideFace(gameWindow) && this.mouseOnFaceDown) {\r\n            this.faceState = \"press\";\r\n        } else if (gameLogic.isGameOver()) {\r\n            this.faceState = \"lose\";\r\n        } else if (gameLogic.isGameWin()) {\r\n            this.faceState = \"win\";\r\n        }\r\n    }\r\n\r\n    private drawRect(sprite: TUiSpriteData) {\r\n        if (!this.context) {\r\n            throw new Error(\"HtmlCanvasUi is not initialized\");\r\n        }\r\n\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuUi drawData in not created!\");\r\n        }\r\n\r\n        const texture = getTheme() === \"dark\" ? this.drawData.uiTextureDark : this.drawData.uiTextureLight;\r\n\r\n        this.context.drawImage(\r\n            texture,\r\n            sprite.atlasPos[0],\r\n            sprite.atlasPos[1],\r\n            sprite.atlasSize[0],\r\n            sprite.atlasSize[1],\r\n            sprite.spritePos[0],\r\n            this.windowHeight - sprite.spritePos[1] - sprite.spriteSize[1],\r\n            sprite.spriteSize[0],\r\n            sprite.spriteSize[1]\r\n        );\r\n    }\r\n\r\n    draw() {\r\n        if (!this.context) {\r\n            throw new Error(\"HTMLCanvasUi is not initialized\");\r\n        }\r\n\r\n        this.drawRect(uiFrameBorderBotLeft(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderBotRight(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderTopLeft(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderTopRight(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderBot(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderTop(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameCenter(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderLeft(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderRight(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderCenterLeft(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderCenterRight(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameBorderCenter(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameInfoLeft(this.windowWidth, this.windowHeight));\r\n        this.drawRect(uiFrameInfoRight(this.windowWidth, this.windowHeight));\r\n\r\n        const minesSlice = [\r\n            Math.floor(this.closedMines / 100) % 10,\r\n            Math.floor(this.closedMines / 10) % 10,\r\n            this.closedMines % 10,\r\n        ];\r\n        for (let i = 0; i < 3; i++) {\r\n            const text = TEXT_ARRAY[minesSlice[i]];\r\n            this.drawRect(\r\n                createUiSpriteData(\r\n                    uiTextMinesPosArray[i](this.windowWidth, this.windowHeight),\r\n                    TEXT_SYM_SIZE,\r\n                    text,\r\n                    TEXT_SIZE\r\n                )\r\n            );\r\n        }\r\n\r\n        const secondsSlice = [\r\n            Math.floor(this.seconds / 100) % 10,\r\n            Math.floor(this.seconds / 10) % 10,\r\n            this.seconds % 10,\r\n        ];\r\n        for (let i = 0; i < 3; i++) {\r\n            const text = TEXT_ARRAY[secondsSlice[i]];\r\n            this.drawRect(\r\n                createUiSpriteData(\r\n                    uiTextTimePosArray[i](this.windowWidth, this.windowHeight),\r\n                    TEXT_SYM_SIZE,\r\n                    text,\r\n                    TEXT_SIZE\r\n                )\r\n            );\r\n        }\r\n\r\n        let faceUvPos = uiFaceDefaultUvPos;\r\n        if (this.faceState === \"press\") {\r\n            faceUvPos = uiFacePressUvPos;\r\n        } else if (this.faceState === \"win\") {\r\n            faceUvPos = uiFaceWinUvPos;\r\n        } else if (this.faceState === \"lose\") {\r\n            faceUvPos = uiFaceLoseUvPos;\r\n        }\r\n\r\n        this.drawRect(\r\n            createUiSpriteData(uiFacePos(this.windowWidth, this.windowHeight), [FACE_SIZE, FACE_SIZE], faceUvPos, [\r\n                FACE_SIZE,\r\n                FACE_SIZE,\r\n            ])\r\n        );\r\n\r\n        if (!this.fieldCameraState.isOnTop) {\r\n            this.drawRect(uiScrollPointTop(this.windowWidth, this.windowHeight));\r\n        }\r\n        if (!this.fieldCameraState.isOnLeft) {\r\n            this.drawRect(uiScrollPointLeft(this.windowWidth, this.windowHeight));\r\n        }\r\n        if (!this.fieldCameraState.isOnRight) {\r\n            this.drawRect(uiScrollPointRight(this.windowWidth, this.windowHeight));\r\n        }\r\n        if (!this.fieldCameraState.isOnBottom) {\r\n            this.drawRect(uiScrollPointBot(this.windowWidth, this.windowHeight));\r\n        }\r\n    }\r\n}\r\n","import { GameWindow } from \"GameWidnow\";\r\n\r\nimport { GameLogic } from \"Game/GameLogic\";\r\nimport { IField, GameField } from \"Game/IField\";\r\nimport { CAMERA_OFFSET_X, CAMERA_OFFSET_Y, FIELD_CELL_SIZE } from \"Game/Constants\";\r\n\r\nimport { createWebGpuBufferDynamic, createWebGpuBufferWithData } from \"WebGpu/WebGpuBuffer\";\r\nimport { createOrthographicMatrix, createTranslationMatrix, Float32ArrayConcat } from \"WebGpu/Matrices\";\r\nimport { createWebGpuTexture } from \"WebGpu/WebGpuTexture\";\r\nimport { gWebGpuInstance } from \"WebGpu/WebGpuInstance\";\r\n\r\nimport { getTheme } from \"Theme\";\r\n\r\nimport vertShaderCode from \"assets/shaders/field.vert.wgsl\";\r\nimport fragShaderCode from \"assets/shaders/field.frag.wgsl\";\r\n\r\ninterface TDrawData {\r\n    pipeline: GPURenderPipeline;\r\n    positionBuffer: GPUBuffer;\r\n    indicesBuffer: GPUBuffer;\r\n    textureIdBuffer: GPUBuffer;\r\n    offsetBuffer: GPUBuffer;\r\n    fieldMatricesBuffer: GPUBuffer;\r\n    fieldTextureUniformBindGroupDark: GPUBindGroup;\r\n    fieldTextureUniformBindGroupLight: GPUBindGroup;\r\n    fieldMatricesUniformBindGroup: GPUBindGroup;\r\n    drawValues: GPUBuffer;\r\n}\r\n\r\nexport class WebGpuField extends GameField implements IField {\r\n    private device: GPUDevice | null = null;\r\n\r\n    private drawData: TDrawData | null = null;\r\n\r\n    async init(width: number, height: number) {\r\n        if (!gWebGpuInstance) {\r\n            throw new Error(\"WebGpuInstance is not initialized\");\r\n        }\r\n\r\n        this.baseInit(width, height);\r\n\r\n        this.device = gWebGpuInstance.getDevice();\r\n\r\n        // prettier-ignore\r\n        const positionBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            [\r\n                [0              , 0              ],\r\n                [FIELD_CELL_SIZE, 0              ],\r\n                [0              , FIELD_CELL_SIZE],\r\n                [FIELD_CELL_SIZE, FIELD_CELL_SIZE],\r\n            ],\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const indicesBuffer = createWebGpuBufferWithData(\r\n            this.device,\r\n            [\r\n                [0, 1, 2],\r\n                [1, 2, 3],\r\n            ],\r\n            Uint32Array,\r\n            GPUBufferUsage.INDEX\r\n        );\r\n        const { maxDrawColCount, maxDrawRowCount } = this.getMaxFieldRowAndColCount(\r\n            this.windowWidth,\r\n            this.windowHeight\r\n        );\r\n\r\n        const textureIdBuffer = createWebGpuBufferDynamic(\r\n            this.device,\r\n            maxDrawColCount * maxDrawRowCount * 4,\r\n            Uint32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const offsetBuffer = createWebGpuBufferDynamic(\r\n            this.device,\r\n            maxDrawColCount * maxDrawRowCount * 2,\r\n            Float32Array,\r\n            GPUBufferUsage.VERTEX\r\n        );\r\n\r\n        const drawIndexedIndirectParameters = new Uint32Array(5);\r\n        drawIndexedIndirectParameters[0] = 6;\r\n        drawIndexedIndirectParameters[1] = maxDrawRowCount * maxDrawColCount;\r\n        drawIndexedIndirectParameters[2] = 0;\r\n        drawIndexedIndirectParameters[3] = 0;\r\n        drawIndexedIndirectParameters[4] = 0;\r\n\r\n        const drawValues = this.device.createBuffer({\r\n            size: 20,\r\n            usage: GPUBufferUsage.INDIRECT | GPUBufferUsage.COPY_DST,\r\n        });\r\n        this.device.queue.writeBuffer(\r\n            drawValues,\r\n            0,\r\n            drawIndexedIndirectParameters,\r\n            0,\r\n            drawIndexedIndirectParameters.length\r\n        );\r\n\r\n        const fieldAtlasTile = (x: number, y: number): string => {\r\n            return `vec2f(${x * 0.125}, ${y * 0.125 + 0.125}), \r\n                vec2f(${x * 0.125 + 0.125}, ${y * 0.125 + 0.125}), \r\n                vec2f(${x * 0.125}, ${y * 0.125}), \r\n                vec2f(${x * 0.125 + 0.125}, ${y * 0.125})`;\r\n        };\r\n\r\n        const fieldAtlasTiles = [\r\n            fieldAtlasTile(0, 0),\r\n            fieldAtlasTile(1, 0),\r\n            fieldAtlasTile(2, 0),\r\n            fieldAtlasTile(3, 0),\r\n            fieldAtlasTile(4, 0),\r\n            fieldAtlasTile(5, 0),\r\n            fieldAtlasTile(6, 0),\r\n            fieldAtlasTile(7, 0),\r\n            fieldAtlasTile(0, 1),\r\n            fieldAtlasTile(1, 1),\r\n            fieldAtlasTile(2, 1),\r\n            fieldAtlasTile(3, 1),\r\n            fieldAtlasTile(4, 1),\r\n            fieldAtlasTile(5, 1),\r\n            fieldAtlasTile(6, 1),\r\n            fieldAtlasTile(7, 1),\r\n            fieldAtlasTile(0, 2),\r\n            fieldAtlasTile(1, 2),\r\n            fieldAtlasTile(2, 2),\r\n            fieldAtlasTile(3, 2),\r\n            fieldAtlasTile(4, 2),\r\n            fieldAtlasTile(5, 2),\r\n            fieldAtlasTile(6, 2),\r\n        ];\r\n\r\n        const vertShaderCodeStr = vertShaderCode\r\n            .replace(\"{{UV_COUNT}}\", `${fieldAtlasTiles.length * 4}`)\r\n            .replace(\"{{UV}}\", fieldAtlasTiles.join(\",\\n\"));\r\n\r\n        const vsmDesc = { code: vertShaderCodeStr };\r\n        const vertModule = this.device.createShaderModule(vsmDesc);\r\n\r\n        const fsmDesc = { code: fragShaderCode };\r\n        const fragModule = this.device.createShaderModule(fsmDesc);\r\n\r\n        const positionAttribDesc: GPUVertexAttribute = {\r\n            shaderLocation: 0,\r\n            offset: 0,\r\n            format: \"float32x2\",\r\n        };\r\n        const positionBufferDesc: GPUVertexBufferLayout = {\r\n            attributes: [positionAttribDesc],\r\n            arrayStride: 4 * 2, // sizeof(float) * 2\r\n            stepMode: \"vertex\",\r\n        };\r\n\r\n        const textureIdAttribDesc: GPUVertexAttribute = {\r\n            shaderLocation: 1,\r\n            offset: 0,\r\n            format: \"uint32\",\r\n        };\r\n        const textureIdBufferDesc: GPUVertexBufferLayout = {\r\n            attributes: [textureIdAttribDesc],\r\n            arrayStride: 4 * 1, // sizeof(int) * 1\r\n            stepMode: \"instance\",\r\n        };\r\n\r\n        const offsetAttribDesc: GPUVertexAttribute = {\r\n            shaderLocation: 2,\r\n            offset: 0,\r\n            format: \"float32x2\",\r\n        };\r\n        const offsetBufferDesc: GPUVertexBufferLayout = {\r\n            attributes: [offsetAttribDesc],\r\n            arrayStride: 4 * 2, // sizeof(float) * 2\r\n            stepMode: \"instance\",\r\n        };\r\n\r\n        const fieldTextureBindGroupLayout: GPUBindGroupLayout = this.device.createBindGroupLayout({\r\n            entries: [\r\n                { binding: 0, visibility: GPUShaderStage.FRAGMENT, sampler: {} },\r\n                { binding: 1, visibility: GPUShaderStage.FRAGMENT, texture: {} },\r\n            ],\r\n        });\r\n\r\n        const fieldMatricesBindGroupLayout: GPUBindGroupLayout = this.device.createBindGroupLayout({\r\n            entries: [{ binding: 0, visibility: GPUShaderStage.VERTEX, buffer: {} }],\r\n        });\r\n\r\n        const pipelineLayoutDesc: GPUPipelineLayoutDescriptor = {\r\n            bindGroupLayouts: [fieldTextureBindGroupLayout, fieldMatricesBindGroupLayout],\r\n        };\r\n        const pipelineLayout = this.device.createPipelineLayout(pipelineLayoutDesc);\r\n\r\n        const vertex: GPUVertexState = {\r\n            module: vertModule,\r\n            entryPoint: \"main\",\r\n            buffers: [positionBufferDesc, textureIdBufferDesc, offsetBufferDesc],\r\n        };\r\n\r\n        const presentationFormat: GPUColorTargetState = { format: \"bgra8unorm\" };\r\n        const fragment: GPUFragmentState = {\r\n            module: fragModule,\r\n            entryPoint: \"main\",\r\n            targets: [presentationFormat],\r\n        };\r\n\r\n        const pipelineDesc: GPURenderPipelineDescriptor = {\r\n            label: \"field-pipeline\",\r\n            layout: pipelineLayout,\r\n\r\n            vertex,\r\n            fragment,\r\n\r\n            // primitive,\r\n        };\r\n        const pipeline = this.device.createRenderPipeline(pipelineDesc);\r\n\r\n        const sampler = this.device.createSampler({\r\n            magFilter: \"nearest\",\r\n            minFilter: \"nearest\",\r\n            mipmapFilter: \"nearest\",\r\n        });\r\n\r\n        const fieldTextureDark = await createWebGpuTexture(this.device, \"./assets/textures/field_atlas_dark.png\");\r\n        const fieldTextureUniformBindGroupDark = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(0),\r\n            entries: [\r\n                { binding: 0, resource: sampler },\r\n                { binding: 1, resource: fieldTextureDark.createView() },\r\n            ],\r\n        });\r\n\r\n        const fieldTextureLight = await createWebGpuTexture(this.device, \"./assets/textures/field_atlas_light.png\");\r\n        const fieldTextureUniformBindGroupLight = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(0),\r\n            entries: [\r\n                { binding: 0, resource: sampler },\r\n                { binding: 1, resource: fieldTextureLight.createView() },\r\n            ],\r\n        });\r\n\r\n        const fieldMatricesBuffer = createWebGpuBufferDynamic(\r\n            this.device,\r\n            4 * 4 * 2,\r\n            Float32Array,\r\n            GPUBufferUsage.UNIFORM\r\n        );\r\n\r\n        const fieldMatricesUniformBindGroup = this.device.createBindGroup({\r\n            layout: pipeline.getBindGroupLayout(1),\r\n            entries: [{ binding: 0, resource: { buffer: fieldMatricesBuffer } }],\r\n        });\r\n\r\n        this.drawData = {\r\n            pipeline,\r\n            positionBuffer,\r\n            indicesBuffer,\r\n            offsetBuffer,\r\n            fieldMatricesBuffer,\r\n            textureIdBuffer,\r\n            fieldMatricesUniformBindGroup,\r\n            fieldTextureUniformBindGroupDark,\r\n            fieldTextureUniformBindGroupLight,\r\n            drawValues,\r\n        };\r\n    }\r\n\r\n    update(gameLogic: GameLogic, gameWindow: GameWindow) {\r\n        if (!this.device) {\r\n            throw new Error(\"WebGpuField is not initialized\");\r\n        }\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuField drawData in not created!\");\r\n        }\r\n\r\n        const { maxDrawColCount, maxDrawRowCount } = this.getMaxFieldRowAndColCount(\r\n            this.windowWidth,\r\n            this.windowHeight\r\n        );\r\n\r\n        const offsetBufferData = new Float32Array(maxDrawColCount * maxDrawRowCount * 2);\r\n\r\n        for (let i = 0; i < maxDrawRowCount * maxDrawColCount; i++) {\r\n            const row = Math.floor(i / maxDrawColCount);\r\n            const col = i % maxDrawColCount;\r\n            offsetBufferData[i * 2 + 0] = col * FIELD_CELL_SIZE;\r\n            offsetBufferData[i * 2 + 1] = row * FIELD_CELL_SIZE;\r\n        }\r\n\r\n        const { col: hoveredCellCol, row: hoveredCellRow } = this.getHoveredCell(gameWindow);\r\n\r\n        const isMouseInside = this.isMouseInside(gameWindow);\r\n        const isLeftMouseButtonPressed = gameWindow.isMouseButtonPressed(0);\r\n        const isHoveredCellOpened =\r\n            gameLogic.isCellExists(hoveredCellCol, hoveredCellRow) &&\r\n            gameLogic.isCellOpened(hoveredCellCol, hoveredCellRow);\r\n\r\n        const textureIdBufferData = new Uint32Array(maxDrawRowCount * maxDrawColCount);\r\n        const textureIdBufferColOffset = Math.ceil(this.cameraPosition.x / FIELD_CELL_SIZE);\r\n        const textureIdBufferRowOffset = Math.ceil(this.cameraPosition.y / FIELD_CELL_SIZE);\r\n        for (let i = 0; i < maxDrawRowCount * maxDrawColCount; i++) {\r\n            const row = Math.floor(i / maxDrawColCount) - textureIdBufferRowOffset;\r\n            const col = (i % maxDrawColCount) - textureIdBufferColOffset;\r\n\r\n            const isPressed =\r\n                gameLogic.isGamePlaying() &&\r\n                isMouseInside &&\r\n                isLeftMouseButtonPressed &&\r\n                ((hoveredCellCol === col && hoveredCellRow === row) ||\r\n                    (isHoveredCellOpened &&\r\n                        Math.abs(hoveredCellCol - col) <= 1 &&\r\n                        Math.abs(hoveredCellRow - row) <= 1));\r\n            textureIdBufferData[i] = this.getFieldTextureId(gameLogic, col, row, isPressed);\r\n        }\r\n\r\n        this.device.queue.writeBuffer(this.drawData.textureIdBuffer, 0, textureIdBufferData);\r\n        this.device.queue.writeBuffer(this.drawData.offsetBuffer, 0, offsetBufferData);\r\n\r\n        this.device.queue.writeBuffer(\r\n            this.drawData.fieldMatricesBuffer,\r\n            0,\r\n            Float32ArrayConcat(\r\n                createOrthographicMatrix(0, this.windowWidth, 0, this.windowHeight, -1, 1),\r\n                createTranslationMatrix(\r\n                    CAMERA_OFFSET_X + (this.cameraPosition.x % FIELD_CELL_SIZE),\r\n                    CAMERA_OFFSET_Y + (this.cameraPosition.y % FIELD_CELL_SIZE),\r\n                    0\r\n                )\r\n            )\r\n        );\r\n    }\r\n\r\n    draw() {\r\n        if (!gWebGpuInstance) {\r\n            throw new Error(\"WebGpuInstance is not initialized\");\r\n        }\r\n        if (!this.drawData) {\r\n            throw new Error(\"WebGpuField drawData in not created!\");\r\n        }\r\n\r\n        const passEncoder = gWebGpuInstance?.getPassEncoder();\r\n\r\n        passEncoder.setPipeline(this.drawData.pipeline);\r\n        passEncoder.setViewport(0, 0, this.windowWidth, this.windowHeight, 0, 1);\r\n        passEncoder.setScissorRect(0, 0, this.windowWidth, this.windowHeight);\r\n\r\n        if (getTheme() === \"dark\") {\r\n            passEncoder.setBindGroup(0, this.drawData.fieldTextureUniformBindGroupDark);\r\n        } else {\r\n            passEncoder.setBindGroup(0, this.drawData.fieldTextureUniformBindGroupLight);\r\n        }\r\n        passEncoder.setBindGroup(1, this.drawData.fieldMatricesUniformBindGroup);\r\n\r\n        passEncoder.setVertexBuffer(0, this.drawData.positionBuffer);\r\n        passEncoder.setVertexBuffer(1, this.drawData.textureIdBuffer);\r\n        passEncoder.setVertexBuffer(2, this.drawData.offsetBuffer);\r\n        passEncoder.setIndexBuffer(this.drawData.indicesBuffer, \"uint32\");\r\n\r\n        passEncoder.drawIndexedIndirect(this.drawData.drawValues, 0);\r\n    }\r\n}\r\n","import { Vec2 } from \"Types\";\r\n\r\nconst CELLS_TO_OPEN_RECURSIVELY_PER_FRAME = 100;\r\n\r\nconst FIELD_SIZE_COL = 0;\r\nconst FIELD_SIZE_ROW = 1;\r\n\r\nconst FIELD_STATE_OPENED = 16;\r\nconst FIELD_STATE_MARKED = 32;\r\n\r\ntype TGameLogicState = \"playing\" | \"win\" | \"gameover\";\r\n\r\nexport class GameLogic {\r\n    private fieldSize: Vec2;\r\n    private mines: number;\r\n\r\n    private field: boolean[];\r\n\r\n    private fieldState: Uint8Array;\r\n    private markedMinesCount: number;\r\n    private closedCellsCount: number;\r\n    private cellsToOpen: number;\r\n    private startTime: Date | undefined;\r\n    private endTime: Date | undefined;\r\n    private gameState: TGameLogicState;\r\n    private isFirstClick: boolean;\r\n    private recursiveOpenNodeStack: number[];\r\n\r\n    constructor(fieldSize: Vec2, mines: number) {\r\n        this.fieldSize = fieldSize;\r\n        this.mines = mines;\r\n        this.field = [];\r\n        this.fieldState = new Uint8Array();\r\n        this.markedMinesCount = 0;\r\n        this.closedCellsCount = this.getFieldSize();\r\n        this.cellsToOpen = this.closedCellsCount - this.mines;\r\n        this.isFirstClick = true;\r\n        this.gameState = \"playing\";\r\n        this.recursiveOpenNodeStack = [];\r\n    }\r\n\r\n    isCellExists(col: number, row: number) {\r\n        return col >= 0 && col < this.fieldSize[FIELD_SIZE_COL] && row >= 0 && row < this.fieldSize[FIELD_SIZE_ROW];\r\n    }\r\n\r\n    checkCellExistsError(col: number, row: number) {\r\n        if (col < 0 || col >= this.fieldSize[FIELD_SIZE_COL] || row < 0 || row >= this.fieldSize[FIELD_SIZE_ROW]) {\r\n            throw new Error(\"Cell is out of field\");\r\n        }\r\n    }\r\n\r\n    getFieldRowSize() {\r\n        return this.fieldSize[FIELD_SIZE_ROW];\r\n    }\r\n\r\n    getFieldColSize() {\r\n        return this.fieldSize[FIELD_SIZE_COL];\r\n    }\r\n\r\n    getFieldMinesCount() {\r\n        return this.mines;\r\n    }\r\n\r\n    getFieldCellId(col: number, row: number) {\r\n        this.checkCellExistsError(col, row);\r\n        return col + row * this.fieldSize[FIELD_SIZE_COL];\r\n    }\r\n\r\n    setFieldSizeAndMines(fieldSize: Vec2, mines: number) {\r\n        this.fieldSize = fieldSize;\r\n        this.mines = mines;\r\n    }\r\n\r\n    isCellHasMine(col: number, row: number): boolean {\r\n        return this.field[this.getFieldCellId(col, row)];\r\n    }\r\n\r\n    getFieldSize() {\r\n        return this.fieldSize[FIELD_SIZE_COL] * this.fieldSize[FIELD_SIZE_ROW];\r\n    }\r\n\r\n    getClosedAndNotMarkedMinesCount() {\r\n        return Math.max(0, this.mines - this.markedMinesCount);\r\n    }\r\n\r\n    getSecondsFromStart() {\r\n        const endTime = this.endTime || new Date();\r\n        return Math.floor(this.startTime ? (endTime.getTime() - this.startTime.getTime()) / 1000 : 0);\r\n    }\r\n\r\n    isCellOpened(col: number, row: number) {\r\n        return (this.fieldState[this.getFieldCellId(col, row)] & FIELD_STATE_OPENED) > 0;\r\n    }\r\n\r\n    isCellMarked(col: number, row: number) {\r\n        return (this.fieldState[this.getFieldCellId(col, row)] & FIELD_STATE_MARKED) > 0;\r\n    }\r\n\r\n    isCellClosed(col: number, row: number) {\r\n        return !this.isCellOpened(col, row);\r\n    }\r\n\r\n    getCellMinesCount(col: number, row: number) {\r\n        return this.fieldState[this.getFieldCellId(col, row)] & 15;\r\n    }\r\n\r\n    getCellMinesCountById(index: number) {\r\n        return this.fieldState[index] & 15;\r\n    }\r\n\r\n    getColAndRowFromCellId(cellId: number) {\r\n        return {\r\n            col: cellId % this.fieldSize[FIELD_SIZE_COL],\r\n            row: Math.floor(cellId / this.fieldSize[FIELD_SIZE_COL]),\r\n        };\r\n    }\r\n\r\n    generateField() {\r\n        this.field = new Array<boolean>(this.getFieldSize()).fill(false);\r\n        this.fieldState = new Uint8Array(this.getFieldSize()).fill(0);\r\n        this.markedMinesCount = 0;\r\n        this.closedCellsCount = this.getFieldSize();\r\n        this.cellsToOpen = this.closedCellsCount - this.mines;\r\n        this.startTime = undefined;\r\n        this.endTime = undefined;\r\n        this.gameState = \"playing\";\r\n        this.isFirstClick = true;\r\n        this.recursiveOpenNodeStack = [];\r\n\r\n        if (this.mines >= this.field.length) {\r\n            this.field = new Array<boolean>(this.field.length).fill(true);\r\n            this.fieldState = new Uint8Array(this.getFieldSize()).fill(9);\r\n            this.mines = this.field.length;\r\n            this.cellsToOpen = 0;\r\n            return;\r\n        }\r\n\r\n        let mines = this.mines;\r\n        while (mines > 0) {\r\n            const index = Math.floor(Math.random() * this.field.length);\r\n            if (!this.field[index]) {\r\n                this.field[index] = true;\r\n                mines--;\r\n                const { col, row } = this.getColAndRowFromCellId(index);\r\n                for (let i = -1; i <= 1; i++) {\r\n                    for (let j = -1; j <= 1; j++) {\r\n                        const colIndex = col + i;\r\n                        const rowIndex = row + j;\r\n                        if (this.isCellExists(colIndex, rowIndex)) {\r\n                            const cellIndex = this.getFieldCellId(colIndex, rowIndex);\r\n                            this.fieldState[cellIndex] += 1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    isGamePlaying() {\r\n        return this.gameState === \"playing\";\r\n    }\r\n\r\n    isGameEnded() {\r\n        return this.gameState !== \"playing\";\r\n    }\r\n\r\n    isGameOver() {\r\n        return this.gameState === \"gameover\";\r\n    }\r\n\r\n    isGameWin() {\r\n        return this.gameState === \"win\";\r\n    }\r\n\r\n    private onGameOver() {\r\n        this.gameState = \"gameover\";\r\n        this.endTime = new Date();\r\n    }\r\n\r\n    private openCellsRecursively() {\r\n        for (let k = 0; k < CELLS_TO_OPEN_RECURSIVELY_PER_FRAME; k++) {\r\n            const node = this.recursiveOpenNodeStack.shift();\r\n            if (node === undefined) {\r\n                this.recursiveOpenNodeStack = [];\r\n                break;\r\n            }\r\n\r\n            const { col, row } = this.getColAndRowFromCellId(node);\r\n            if (this.isCellOpened(col, row) || this.isCellMarked(col, row)) {\r\n                continue;\r\n            }\r\n\r\n            this.fieldState[node] |= FIELD_STATE_OPENED;\r\n            this.closedCellsCount--;\r\n\r\n            if (this.getCellMinesCountById(node) === 0) {\r\n                for (let i = -1; i <= 1; i++) {\r\n                    for (let j = -1; j <= 1; j++) {\r\n                        const colIndex = col + i;\r\n                        const rowIndex = row + j;\r\n                        if (this.isCellExists(colIndex, rowIndex)) {\r\n                            const cellIndex = this.getFieldCellId(colIndex, rowIndex);\r\n                            if (this.isCellClosed(colIndex, rowIndex)) {\r\n                                this.recursiveOpenNodeStack.push(cellIndex);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (this.recursiveOpenNodeStack.length === 0) {\r\n                this.recursiveOpenNodeStack = [];\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    openCell(col: number, row: number) {\r\n        if (this.gameState !== \"playing\" || this.recursiveOpenNodeStack.length > 0) {\r\n            return;\r\n        }\r\n\r\n        const isFirstClick = this.isFirstClick;\r\n        this.isFirstClick = false;\r\n\r\n        if (this.startTime === undefined) {\r\n            this.startTime = new Date();\r\n        }\r\n\r\n        if (this.isCellMarked(col, row)) {\r\n            return;\r\n        }\r\n\r\n        if (this.isCellHasMine(col, row)) {\r\n            // TODO: implement on first click handle better way\r\n            if (isFirstClick) {\r\n                const index = this.getFieldCellId(col, row);\r\n                let cellForMineIndex = -1;\r\n                let iterations = 1000;\r\n                while (cellForMineIndex === -1 && iterations-- > 0) {\r\n                    const newIndex = Math.floor(Math.random() * this.field.length);\r\n                    if (!this.field[newIndex]) {\r\n                        cellForMineIndex = newIndex;\r\n                    }\r\n                }\r\n                if (cellForMineIndex === -1) {\r\n                    for (let i = 0; i < this.field.length; i++) {\r\n                        if (!this.field[i] && index !== i) {\r\n                            cellForMineIndex = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.field[index] = false;\r\n                this.field[cellForMineIndex] = true;\r\n                const { col: cellForMineCol, row: cellForMineRow } = this.getColAndRowFromCellId(cellForMineIndex);\r\n                for (let i = -1; i <= 1; i++) {\r\n                    for (let j = -1; j <= 1; j++) {\r\n                        const colIndex = col + i;\r\n                        const rowIndex = row + j;\r\n                        if (this.isCellExists(colIndex, rowIndex)) {\r\n                            const cellIndex = this.getFieldCellId(colIndex, rowIndex);\r\n                            this.fieldState[cellIndex] -= 1;\r\n                        }\r\n                        const cellForMineColIndex = cellForMineCol + i;\r\n                        const cellForMineRowIndex = cellForMineRow + j;\r\n                        if (this.isCellExists(cellForMineColIndex, cellForMineRowIndex)) {\r\n                            const cellForMineCellIndex = this.getFieldCellId(cellForMineColIndex, cellForMineRowIndex);\r\n                            this.fieldState[cellForMineCellIndex] += 1;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                this.fieldState[this.getFieldCellId(col, row)] |= FIELD_STATE_OPENED;\r\n                this.onGameOver();\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (this.isCellOpened(col, row)) {\r\n            const minesAround = this.getCellMinesCount(col, row);\r\n            let hasWrongMark = false;\r\n            let markedMinesAround = 0;\r\n            let closedCellsAround = 0;\r\n            for (let i = -1; i <= 1; i++) {\r\n                for (let j = -1; j <= 1; j++) {\r\n                    const colIndex = col + i;\r\n                    const rowIndex = row + j;\r\n                    if (this.isCellExists(colIndex, rowIndex) && this.isCellMarked(colIndex, rowIndex)) {\r\n                        markedMinesAround++;\r\n                        if (!this.isCellHasMine(colIndex, rowIndex)) {\r\n                            hasWrongMark = true;\r\n                        }\r\n                    }\r\n                    if (this.isCellExists(colIndex, rowIndex) && this.isCellClosed(colIndex, rowIndex)) {\r\n                        closedCellsAround++;\r\n                    }\r\n                }\r\n            }\r\n            if (minesAround === markedMinesAround) {\r\n                if (hasWrongMark) {\r\n                    for (let i = -1; i <= 1; i++) {\r\n                        for (let j = -1; j <= 1; j++) {\r\n                            const colIndex = col + i;\r\n                            const rowIndex = row + j;\r\n                            if (this.isCellExists(colIndex, rowIndex) && !this.isCellMarked(colIndex, rowIndex)) {\r\n                                this.fieldState[this.getFieldCellId(colIndex, rowIndex)] |= FIELD_STATE_OPENED;\r\n                            }\r\n                        }\r\n                    }\r\n                    this.onGameOver();\r\n                    return;\r\n                }\r\n                this.recursiveOpenNodeStack = [];\r\n                for (let i = -1; i <= 1; i++) {\r\n                    for (let j = -1; j <= 1; j++) {\r\n                        const colIndex = col + i;\r\n                        const rowIndex = row + j;\r\n                        if (this.isCellExists(colIndex, rowIndex) && !this.isCellMarked(colIndex, rowIndex)) {\r\n                            const index = this.getFieldCellId(colIndex, rowIndex);\r\n                            this.recursiveOpenNodeStack.push(index);\r\n                        }\r\n                    }\r\n                }\r\n            } else if (minesAround === closedCellsAround) {\r\n                for (let i = -1; i <= 1; i++) {\r\n                    for (let j = -1; j <= 1; j++) {\r\n                        const colIndex = col + i;\r\n                        const rowIndex = row + j;\r\n                        if (\r\n                            this.isCellExists(colIndex, rowIndex) &&\r\n                            !this.isCellMarked(colIndex, rowIndex) &&\r\n                            this.isCellClosed(colIndex, rowIndex)\r\n                        ) {\r\n                            this.markCell(colIndex, rowIndex);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            const index = this.getFieldCellId(col, row);\r\n            this.recursiveOpenNodeStack = [index];\r\n        }\r\n    }\r\n\r\n    markCell(col: number, row: number) {\r\n        if (this.gameState !== \"playing\" || this.recursiveOpenNodeStack.length > 0) {\r\n            return;\r\n        }\r\n\r\n        this.isFirstClick = false;\r\n\r\n        const index = this.getFieldCellId(col, row);\r\n\r\n        if (this.startTime === undefined) {\r\n            this.startTime = new Date();\r\n        }\r\n\r\n        if (this.isCellOpened(col, row)) {\r\n            return;\r\n        }\r\n\r\n        if (this.isCellMarked(col, row)) {\r\n            this.fieldState[index] &= ~FIELD_STATE_MARKED;\r\n            this.markedMinesCount--;\r\n        } else {\r\n            this.fieldState[index] |= FIELD_STATE_MARKED;\r\n            this.markedMinesCount++;\r\n        }\r\n    }\r\n\r\n    update() {\r\n        this.openCellsRecursively();\r\n        if (this.getFieldSize() - this.closedCellsCount === this.cellsToOpen && this.gameState === \"playing\") {\r\n            this.gameState = \"win\";\r\n            this.endTime = new Date();\r\n        }\r\n    }\r\n\r\n    save() {\r\n        return {\r\n            fieldSize: this.fieldSize,\r\n            mines: this.mines,\r\n            field: this.field,\r\n            fieldState: Array.from(this.fieldState),\r\n            markedMinesCount: this.markedMinesCount,\r\n            closedCellsCount: this.closedCellsCount,\r\n            cellsToOpen: this.cellsToOpen,\r\n            startTime: this.startTime,\r\n            endTime: this.endTime,\r\n            gameState: this.gameState,\r\n            isFirstClick: this.isFirstClick,\r\n            recursiveOpenNodeStack: this.recursiveOpenNodeStack,\r\n        };\r\n    }\r\n\r\n    load(data: any) {\r\n        this.fieldSize = data.fieldSize;\r\n        this.mines = data.mines;\r\n        this.field = data.field;\r\n        this.fieldState = new Uint8Array(data.fieldState);\r\n        this.markedMinesCount = data.markedMinesCount;\r\n        this.closedCellsCount = data.closedCellsCount;\r\n        this.cellsToOpen = data.cellsToOpen;\r\n        this.startTime = data.startTime;\r\n        this.endTime = data.endTime;\r\n        this.gameState = data.gameState;\r\n        this.isFirstClick = data.isFirstClick;\r\n        this.recursiveOpenNodeStack = data.recursiveOpenNodeStack;\r\n    }\r\n\r\n    consolePrint() {\r\n        const resultStrArr: string[] = [];\r\n        for (let row = 0; row < this.fieldSize[FIELD_SIZE_ROW]; row++) {\r\n            let resultStr = \"\";\r\n            for (let col = 0; col < this.fieldSize[FIELD_SIZE_COL]; col++) {\r\n                resultStr += this.isCellHasMine(col, row) ? \"@\" : \"#\";\r\n            }\r\n            resultStrArr.push(resultStr);\r\n        }\r\n        console.log(resultStrArr.reverse().join(\"\\n\"));\r\n    }\r\n}\r\n","import { BORDER_X, BORDER_Y, FIELD_CELL_SIZE, INFO_Y } from \"./Constants\";\r\n\r\nexport const calcCanvasSize = (cols: number, rows: number) => {\r\n    return {\r\n        width: Math.min(1280, cols * FIELD_CELL_SIZE + BORDER_X * 2),\r\n        height: Math.min(720, rows * FIELD_CELL_SIZE + BORDER_Y * 3 + INFO_Y),\r\n    };\r\n};\r\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","nc","GameWindow","constructor","canvas","onMouseButtonDown","onMouseButtonUp","onWheel","_defineProperty","Set","addEventListener","mouseButtonsPressed","add","button","delete","mousePosition","clientX","clientY","preventDefault","stopPropagation","x","shiftKey","deltaY","deltaX","y","setOnMouseButtonDown","func","setOnMouseButtonUp","setOnWheel","isMouseButtonPressed","has","getMousePosition","getBoundingClientRect","left","bottom","isMouseInside","mousePos","width","height","FIELD_CELL_SIZE","TEXT_SIZE","BORDER_X","BORDER_Y","INFO_Y","TEXT_X","FACE_SIZE","TEXT_SYM_SIZE","TEXTURE_SIZE","getRendererType","localStorage","getItem","startNewGame","cols","rows","mines","location","href","gWebGpuInstance","GameField","gameLogic","col","row","isPressed","isCellExists","isGameOver","isCellMarked","isCellHasMine","isCellOpened","isGameWin","isCellClosed","getCellMinesCount","baseInit","windowWidth","windowHeight","isScrollAllowed","calcCameraMaxLimits","getFieldColSize","getFieldRowSize","moveCamera","cameraPosition","maxX","maxY","Math","min","max","getHoveredCell","gameWindow","floor","getFieldCameraState","epsilon","isOnBottom","abs","isOnTop","isOnLeft","isOnRight","getMaxFieldRowAndColCount","maxDrawColCount","maxDrawRowCount","createWebGpuBufferWithData","device","inData","dataType","usage","flat","bufferDescriptor","size","byteLength","mappedAtCreation","buffer","createBuffer","getMappedRange","set","unmap","createWebGpuBufferDynamic","BYTES_PER_ELEMENT","GPUBufferUsage","COPY_DST","createOrthographicMatrix","right","top","near","far","Float32Array","createWebGpuTexture","async","filename","response","fetch","imageBitmap","createImageBitmap","blob","texture","createTexture","format","GPUTextureUsage","TEXTURE_BINDING","RENDER_ATTACHMENT","queue","copyExternalImageToTexture","source","getTheme","documentElement","getAttribute","TEXT_ARRAY","GameUi","isMouseInsideFace","faceOffsetX","faceOffsetY","checkFaceClickDown","mouseOnFaceDown","checkFaceClickUp","generateField","createUiSpriteData","spritePos","spriteSize","atlasPos","atlasSize","textBlockOffsetY","TEXT_Y","uiFrameBorderBotLeft","uiFrameBorderBotRight","uiFrameBorderTopLeft","uiFrameBorderTopRight","uiFrameBorderBot","uiFrameBorderTop","uiFrameCenter","uiFrameBorderLeft","uiFrameBorderRight","uiFrameBorderCenterLeft","uiFrameBorderCenterRight","uiFrameBorderCenter","uiFrameInfoLeft","uiFrameInfoRight","scrollPointWidthCenter","SCROLL_POINT_Y","scrollPointHeightCenter","uiScrollLeftUvPos","uiScrollRightUvPos","uiScrollTopUvPos","uiScrollBotUvPos","uiScrollXUvSize","uiScrollYUvSize","uiScrollPointLeft","uiScrollPointRight","uiScrollPointTop","uiScrollPointBot","uiFacePos","uiFaceDefaultUvPos","uiFaceWinUvPos","uiFaceLoseUvPos","uiFacePressUvPos","textOffsetY","uiTextMinesPos0","uiTextMinesPos1","uiTextMinesPos2","uiTextTimePos0","uiTextTimePos1","uiTextTimePos2","uiTextMinesPosArray","uiTextTimePosArray","getPos","position","getUV","genVBOs","sprites","positions","uvs","indices","sprite","pos","uv","gHtmlCanvasInstance","createHtmlCanvasTexture","Promise","resolve","reject","img","Image","onload","onerror","src","locals","InstanceType","init","context","getContext","beginFrame","clearRect","endFrame","FieldType","arguments","Uint8Array","textureIdArray","uiTextureDark","uiTextureLight","drawData","hoveredCellCol","hoveredCellRow","isLeftMouseButtonPressed","isHoveredCellOpened","textureIdBufferColOffset","ceil","textureIdBufferRowOffset","isGamePlaying","getFieldTextureId","drawRect","textureId","drawImage","draw","offsetX","offsetY","UiType","fieldCameraState","closedMines","getClosedAndNotMarkedMinesCount","seconds","getSecondsFromStart","faceState","minesSlice","text","secondsSlice","faceUvPos","console","log","instance","navigator","gpu","adapter","requestAdapter","requestDevice","presentationFormat","getPreferredCanvasFormat","canvasConfig","alphaMode","COPY_SRC","configure","error","getColorTextureView","getCurrentTexture","createView","getDevice","renderPassDesc","colorAttachments","view","clearValue","r","g","b","loadOp","storeOp","currentFrameCommandEncoder","createCommandEncoder","currentFramePassEncoder","beginRenderPass","end","submit","finish","getPassEncoder","positionBuffer","VERTEX","indicesBuffer","Uint32Array","INDEX","textureIdBuffer","offsetBuffer","drawIndexedIndirectParameters","drawValues","INDIRECT","writeBuffer","fieldAtlasTile","fieldAtlasTiles","vsmDesc","code","replace","vertModule","createShaderModule","fragModule","pipelineLayoutDesc","bindGroupLayouts","createBindGroupLayout","entries","binding","visibility","GPUShaderStage","FRAGMENT","sampler","pipelineDesc","label","layout","createPipelineLayout","vertex","entryPoint","buffers","shaderLocation","offset","arrayStride","stepMode","fragment","targets","pipeline","createRenderPipeline","createSampler","magFilter","minFilter","mipmapFilter","fieldTextureDark","fieldTextureUniformBindGroupDark","createBindGroup","getBindGroupLayout","resource","fieldTextureLight","fieldTextureUniformBindGroupLight","fieldMatricesBuffer","UNIFORM","fieldMatricesUniformBindGroup","offsetBufferData","textureIdBufferData","createTranslationMatrix","Float32ArrayConcat","passEncoder","setPipeline","setViewport","setScissorRect","setBindGroup","setVertexBuffer","setIndexBuffer","drawIndexedIndirect","staticPositions","staticUVs","staticIndices","staticPositionBuffer","staticTextureCoordBuffer","staticIndicesBuffer","staticIndicesCount","dynamicPositions","dynamicUVs","dynamicIndices","dynamicPositionBuffer","dynamicTextureCoordBuffer","dynamicIndicesBuffer","dynamicIndicesCount","blend","color","srcFactor","dstFactor","alpha","uiTextureUniformBindGroupDark","uiTextureUniformBindGroupLight","uiMatricesBuffer","uiMatricesUniformBindGroup","dynamicTextureCoordBufferData","drawIndexed","getElementById","innerHTML","_document$getElementB","switchRendererType","newRendererType","setItem","reload","detectColorScheme","theme","matchMedia","matches","themeToggleSwitch","themeIcon","checked","_document$getElementB2","formData","FormData","parseInt","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","load","getStartupInputs","params","URLSearchParams","search","fieldSize","field","fieldState","markedMinesCount","closedCellsCount","getFieldSize","cellsToOpen","isFirstClick","gameState","recursiveOpenNodeStack","checkCellExistsError","getFieldMinesCount","getFieldCellId","setFieldSizeAndMines","endTime","Date","startTime","getTime","getCellMinesCountById","getColAndRowFromCellId","cellId","Array","fill","random","j","colIndex","rowIndex","cellIndex","isGameEnded","onGameOver","openCellsRecursively","node","shift","openCell","cellForMineIndex","iterations","newIndex","cellForMineCol","cellForMineRow","cellForMineColIndex","cellForMineRowIndex","cellForMineCellIndex","minesAround","hasWrongMark","markedMinesAround","closedCellsAround","markCell","save","from","consolePrint","resultStrArr","resultStr","reverse","start","canvasWidth","canvasHeight","calcCanvasSize","ui","hoveredCell","render","requestAnimationFrame","gameDataBase","onDBReady","onDBError","openRequest","indexedDB","open","onsuccess","db","onupgradeneeded","createObjectStore","keyPath","saveGame","_this$db","tx","transaction","store","objectStore","put","loadGame","onLoadSuccess","onLoadError","_this$db2","request","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB10","history","replaceState","_document$getElementB11","_document$getElementB12","_document$getElementB13"],"sourceRoot":""}